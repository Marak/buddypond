var geckos;geckos=(()=>{"use strict";var e={816:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(28));t.default=o.default},28:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientChannel=void 0;var a=n(856),s=n(651),c=i(n(460)),u=i(n(567)),l=function(){function e(e,t,n,r,o){var i=this;this.userData={},this.receivedReliableMessages=[],this.url=n?e+":"+n:e,this.connectionsManager=new u.default(this.url,t,r,o),this.bridge=this.connectionsManager.bridge,this.bridge.on(s.EVENTS.DISCONNECTED,(function(){return i.bridge.removeAllListeners()}))}return e.prototype.onconnectionstatechange=function(){var e=this,t=this.peerConnection.localPeerConnection;t.onconnectionstatechange=function(){"disconnected"!==t.connectionState&&"closed"!==t.connectionState||e.bridge.emit(s.EVENTS.DISCONNECTED)}},Object.defineProperty(e.prototype,"id",{get:function(){return this.peerConnection.id},enumerable:!1,configurable:!0}),e.prototype.close=function(){this.peerConnection.localPeerConnection.close(),this.bridge.emit(s.EVENTS.DISCONNECTED);try{var e=this.url+"/.wrtc/v1";fetch(e+"/connections/"+this.id+"/close",{method:"POST",headers:{"Content-Type":"application/json"}})}catch(e){console.error(e.message)}},e.prototype.emit=function(e,t,n){var r=this;void 0===t&&(t=null),n&&n.reliable?a.makeReliable(n,(function(n){return r.connectionsManager.emit(e,{MESSAGE:t,RELIABLE:1,ID:n})})):this.connectionsManager.emit(e,t)},Object.defineProperty(e.prototype,"raw",{get:function(){var e=this;return{emit:function(t){return e.emit(s.EVENTS.RAW_MESSAGE,t)}}},enumerable:!1,configurable:!0}),e.prototype.onRaw=function(e){this.bridge.on(s.EVENTS.RAW_MESSAGE,(function(t){!function(t){e(t)}(t)}))},e.prototype.onConnect=function(e){var t;return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return this.peerConnection=new c.default,[4,this.peerConnection.connect(this.connectionsManager)];case 1:return(n=r.sent()).error?e(n.error):(n.userData&&(this.userData=n.userData),this.maxMessageSize=this.connectionsManager.maxMessageSize=null===(t=this.peerConnection.localPeerConnection.sctp)||void 0===t?void 0:t.maxMessageSize,this.onconnectionstatechange(),e()),[2]}}))}))},e.prototype.onDisconnect=function(e){this.bridge.on(s.EVENTS.DISCONNECTED,e)},e.prototype.on=function(e,t){var n=this;this.bridge.on(e,(function(e){var r;e&&1===e.RELIABLE&&"undefined"!==e.ID?(r=(new Date).getTime(),n.receivedReliableMessages.forEach((function(e,t,n){e.expire<=r&&n.splice(t,1)})),0===n.receivedReliableMessages.filter((function(t){return t.id===e.ID})).length&&(n.receivedReliableMessages.push({id:e.ID,timestamp:new Date,expire:(new Date).getTime()+15e3}),t(e.MESSAGE))):t(e)}))},e}();t.ClientChannel=l;t.default=function(e){void 0===e&&(e={});var t=e.iceServers,n=void 0===t?[]:t,r=e.iceTransportPolicy,o=void 0===r?"all":r,i=e.url,a=void 0===i?location.protocol+"//"+location.hostname:i,s=e.authorization,c=void 0===s?void 0:s,u=e.port,f=void 0===u?9208:u,h=e.label;return new l(a,c,f,void 0===h?"geckos.io":h,{iceServers:n,iceTransportPolicy:o})}},567:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(624),c=a(n(997)),u=a(n(208)),l=function(){function e(e,t,n,r){var o=this;this.url=e,this.authorization=t,this.label=n,this.rtcConfiguration=r,this.bridge=new s.Bridge,this.onDataChannel=function(e){var t=e.channel;t.label===o.label&&(o.dataChannel=t,o.dataChannel.binaryType="arraybuffer",o.dataChannel.onmessage=function(e){var t=c.default(e),n=t.key,r=t.data;o.bridge.emit(n,r)})}}return e.prototype.emit=function(e,t){void 0===t&&(t=null),u.default(this.dataChannel,this.maxMessageSize,e,t)},e.prototype.fetchAdditionalCandidates=function(e,t){return o(this,void 0,void 0,(function(){var n,r=this;return i(this,(function(o){switch(o.label){case 0:return[4,fetch(e+"/connections/"+t+"/additional-candidates",{method:"GET",headers:{"Content-Type":"application/json"}})];case 1:return(n=o.sent()).ok?[4,n.json()]:[3,3];case 2:o.sent().forEach((function(e){r.localPeerConnection.addIceCandidate(e)})),o.label=3;case 3:return[2]}}))}))},e.prototype.connect=function(){return o(this,void 0,void 0,(function(){var e,t,n,o,a,s,c,u,l,f,h,d,p,v,y,_,b=this;return i(this,(function(i){switch(i.label){case 0:e=this.url+"/.wrtc/v1",t={"Content-Type":"application/json"},this.authorization&&(t=r(r({},t),((_={}).Authorization=this.authorization,_))),n={},i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(e+"/connections",{method:"POST",headers:t})];case 2:return[4,i.sent().json()];case 3:return o=i.sent(),n=o.userData,this.remotePeerConnection=o,[3,5];case 4:return a=i.sent(),console.error(a.message),[2,{error:a}];case 5:s=this.remotePeerConnection,c=s.id,u=s.localDescription,l=r({sdpSemantics:"unified-plan"},this.rtcConfiguration),f=RTCPeerConnection||webkitRTCPeerConnection||mozRTCPeerConnection,this.localPeerConnection=new f(l),function(e,t,n,r){return void 0===e&&(e=10),void 0===t&&(t=50),void 0===n&&(n=1.8),void 0===r&&(r=20),Array(e).fill(0).map((function(e,o){return parseInt((t*Math.pow(n,o)).toString())+parseInt((Math.random()*r).toString())}))}().forEach((function(t){setTimeout((function(){b.fetchAdditionalCandidates(e,c)}),t)})),i.label=6;case 6:return i.trys.push([6,16,,17]),[4,this.localPeerConnection.setRemoteDescription(u)];case 7:return i.sent(),this.localPeerConnection.addEventListener("datachannel",this.onDataChannel,{once:!0}),[4,this.localPeerConnection.createAnswer()];case 8:return h=i.sent(),d=new RTCSessionDescription({type:"answer",sdp:h.sdp}),[4,this.localPeerConnection.setLocalDescription(d)];case 9:i.sent(),i.label=10;case 10:return i.trys.push([10,12,,13]),[4,fetch(e+"/connections/"+c+"/remote-description",{method:"POST",body:JSON.stringify(this.localPeerConnection.localDescription),headers:{"Content-Type":"application/json"}})];case 11:return i.sent(),[3,13];case 12:return p=i.sent(),console.error(p.message),[2,{error:p}];case 13:return v=function(){return new Promise((function(e){b.localPeerConnection.addEventListener("datachannel",(function(){e()}),{once:!0})}))},this.dataChannel?[3,15]:[4,v()];case 14:i.sent(),i.label=15;case 15:return[2,{userData:n,localPeerConnection:this.localPeerConnection,dataChannel:this.dataChannel,id:c}];case 16:return y=i.sent(),console.error(y.message),this.localPeerConnection.close(),[2,{error:y}];case 17:return[2]}}))}))},e}();t.default=l},460:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(651),a=function(){function e(){}return e.prototype.connect=function(e){return r(this,void 0,void 0,(function(){var t,n,r,a,s,c;return o(this,(function(o){switch(o.label){case 0:return RTCPeerConnection||webkitRTCPeerConnection||mozRTCPeerConnection?[4,e.connect()]:[3,2];case 1:return t=o.sent(),n=t.localPeerConnection,r=t.dataChannel,a=t.id,s=t.userData,(c=t.error)?[2,{error:c}]:n&&r&&a&&s?(this.localPeerConnection=n,this.dataChannel=r,this.id=a,[2,{userData:s}]):[2,{error:new Error('Something went wrong in "await connectionsManager.connect()"')}];case 2:return c=new Error(i.ERRORS.BROWSER_NOT_SUPPORTED),console.error(c.message),[2,{error:c}]}}))}))},e}();t.default=a},624:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Bridge=void 0;var o=r(n(186)),i=function(){function e(){this.eventEmitter=new o.default}return e.prototype.emit=function(e,t,n){void 0===n&&(n={}),this.eventEmitter.emit(e,t,n)},e.prototype.on=function(e,t){return this.eventEmitter.on(e,(function(e,n){t(e,n)}))},e.prototype.removeAllListeners=function(){this.eventEmitter.removeAllListeners()},e}();t.Bridge=i;var a=new i;t.default=a},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ERRORS=t.EVENTS=void 0;t.EVENTS={SEND_OVER_DATA_CHANNEL:"sendOverDataChannel",RECEIVED_FROM_DATA_CHANNEL:"receiveFromDataChannel",DISCONNECTED:"disconnected",DISCONNECT:"disconnect",CONNECTION:"connection",CONNECT:"connect",ERROR:"error",DATA_CHANNEL_IS_OPEN:"dataChannelIsOpen",RAW_MESSAGE:"rawMessage",DROP:"dropped"};t.ERRORS={BROWSER_NOT_SUPPORTED:"BROWSER_NOT_SUPPORTED",COULD_NOT_PARSE_MESSAGE:"COULD_NOT_PARSE_MESSAGE",DROPPED_FROM_BUFFERING:"DROPPED_FROM_BUFFERING",MAX_MESSAGE_SIZE_EXCEEDED:"MAX_MESSAGE_SIZE_EXCEEDED"}},142:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isJSONString=t.isObject=t.isRawMessage=void 0;var r=n(487);t.isRawMessage=function(e){return"string"==typeof e||e instanceof ArrayBuffer||e instanceof r.ArrayBufferView};t.isObject=function(e){return"object"==typeof e};t.isJSONString=function(e){try{return"string"==typeof e&&(!!isNaN(parseInt(e))&&(JSON.parse(e),!0))}catch(e){return!1}}},155:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){void 0===e&&(e=24);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}},997:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(651),o=n(142);t.default=function(e){var t,n,i=e.data,a=o.isJSONString(i);return!a&&o.isRawMessage(i)?(t=r.EVENTS.RAW_MESSAGE,n=i):a?n=(i=JSON.parse(i))[t=Object.keys(i)[0]]:(t="error",n=new Error(r.ERRORS.COULD_NOT_PARSE_MESSAGE)),{key:t,data:n}}},856:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.makeReliable=void 0;var o=r(n(155)),i=r(n(356));t.makeReliable=function(e,t){var n=e.interval,r=void 0===n?150:n,a=e.runs,s=void 0===a?10:a,c=o.default(24);i.default(r,s,(function(){t(c)}))}},356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){void 0===e&&(e=200),void 0===t&&(t=1);var r=0;if("function"==typeof n){var o=setInterval((function(){n(),++r===t-1&&clearInterval(o)}),e);n()}else console.error("You have to define your callback function!")}},208:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(142),o=n(651);t.default=function(e,t,n,i){var a;void 0===i&&(i=null);var s=function(n){var r,o=null!==(r=n.byteLength)&&void 0!==r?r:2*n.length;if("number"==typeof t&&o>t)throw new Error("maxMessageSize of "+t+" exceeded");Promise.resolve().then((function(){e.send(n)}))};if("open"===e.readyState)try{n===o.EVENTS.RAW_MESSAGE&&null!==i&&r.isRawMessage(i)?s(i):s(JSON.stringify(((a={})[n]=i,a)))}catch(e){return console.error("Error in sendMessage.ts: ",e.message),e}}},487:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayBufferView=void 0;var n=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;t.ArrayBufferView=n},186:e=>{var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,i||e,a),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,o,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,a),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,o);break;default:if(!c)for(h=1,c=new Array(f-1);h<f;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||o&&!s.once||r&&s.context!==r||a(this,i);else{for(var c=0,u=[],l=s.length;c<l;c++)(s[c].fn!==t||o&&!s[c].once||r&&s[c].context!==r)&&u.push(s[c]);u.length?this._events[i]=1===u.length?u[0]:u:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}},t={};return function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(816)})().default;