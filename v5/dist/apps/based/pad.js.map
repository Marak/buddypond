{"version":3,"file":"pad.js","sources":["../../../apps/based/pad/lib/defaultPadFiles.js","../../../apps/based/pad/lib/buildPad.js","../../../apps/based/desktop/lib/appList.js","../../../apps/based/pad/pad.js","../../../apps/based/pad/lib/renderPadRows.js","../../../apps/based/pad/lib/savePad.js","../../../apps/based/pad/lib/renderAppList.js"],"sourcesContent":["// Default index.html content for a new BuddyPad\nconst defaultIndexHtml = `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Welcome to Your BuddyPad</title>\n    <link rel=\"stylesheet\" href=\"./style.css\">\n</head>\n<body>\n    <h1>Your BuddyPad</h1>\n    <div class=\"welcome-section\">\n        <p>Welcome to your BuddyPad, a custom page hosted on the BuddyPond CDN!</p>\n        <p><strong>About BuddyPads:</strong></p>\n        <p>BuddyPads are custom routed pages on BuddyPond, allowing you to host any static content. Each BuddyPad is stored as a virtual directory in our CDN, accessible via the <strong>Buddy Files</strong> app in the \"pads\" folder.</p>\n        <p><strong>How to Customize Your BuddyPad:</strong></p>\n        <ul>\n            <li><strong>This Default Pad</strong>: This page includes <code>index.html</code> (structure), <code>style.css</code> (styling), and <code>index.js</code> (interactivity). These are linked using relative paths (e.g., <code>./style.css</code>, <code>./index.js</code>).</li>\n            <li><strong>Upload Any Files</strong>: Use the <strong>Buddy Files</strong> app (navigate to the \"pads\" folder) to upload any static files, such as HTML, CSS, JS, images, or entire projects (e.g., React, Vue, or static sites).</li>\n            <li><strong>Flexible Structure</strong>: You're not limited to these default files. Create multiple files, folders, or complex project structures. The BuddyPond CDN serves your content as configured.</li>\n            <li><strong>Accessing Your Pad</strong>: Your BuddyPad is hosted at a unique URL and served directly from our CDN for fast, reliable delivery.</li>\n        </ul>\n        <p><strong>Try It Out:</strong> Click the button below to toggle the color of the boxes, demonstrating how HTML, CSS, and JS work together.</p>\n        <button id=\"toggleButton\">Toggle Box Colors</button>\n        <div class=\"box-container\">\n            <div class=\"color-box\"></div>\n            <div class=\"color-box\"></div>\n            <div class=\"color-box\"></div>\n        </div>\n    </div>\n    <script src=\"./index.js\"></script>\n</body>\n</html>\n`;\n\n// Default style.css content for a new BuddyPad\nconst defaultStyleCss = `\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    background-color: #f4f4f9;\n    color: #333;\n    margin: 0;\n    padding: 20px;\n    line-height: 1.6;\n}\nh1 {\n    color: #007bff;\n    text-align: center;\n}\n.welcome-section {\n    max-width: 800px;\n    margin: 0 auto;\n    background: white;\n    padding: 20px;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\nul {\n    padding-left: 20px;\n}\ncode {\n    background: #f0f0f0;\n    padding: 2px 4px;\n    border-radius: 4px;\n}\nbutton {\n    background-color: #007bff;\n    color: white;\n    padding: 10px 20px;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    display: block;\n    margin: 20px auto;\n}\nbutton:hover {\n    background-color: #0056b3;\n}\n.box-container {\n    display: flex;\n    gap: 20px;\n    justify-content: center;\n}\n.color-box {\n    width: 100px;\n    height: 100px;\n    background-color: #28a745;\n    border-radius: 10px;\n    transition: background-color 0.3s ease;\n}\n.color-box.toggled {\n    background-color: #dc3545;\n}\n`;\n\n// Default index.js content for a new BuddyPad\nconst defaultJs = `\nconsole.log('Welcome to your BuddyPad!');\n// Example: Using querySelectorAll to add interactivity\nconst boxes = document.querySelectorAll('.color-box');\nconst toggleButton = document.getElementById('toggleButton');\n\ntoggleButton.addEventListener('click', () => {\n    boxes.forEach(box => {\n        box.classList.toggle('toggled');\n    });\n});\n`;\n\nlet defaultFiles = {\n    'index.html': defaultIndexHtml,\n    'style.css': defaultStyleCss,\n    'index.js': defaultJs\n};\n\nexport default defaultFiles;","// similiar to generateDefaultProfile(), but is not intended to be called each logic\n// also will have separate code path for pad templates\nimport defaultPadFiles from './defaultPadFiles.js';\n\nexport default async function buildPad(padName, template = 'default') {\n    const basePath = \"https://files.buddypond.com/\" + this.bp.me;\n\n    for (const [fileName, fileContent] of Object.entries(defaultPadFiles)) {\n        console.log(`Creating ${fileName}`);\n        const blob = new Blob([fileContent], { type: getFileType(fileName) });\n        const file = new File([blob], fileName, {\n            type: blob.type,\n            lastModified: new Date()\n        });\n        file.filePath = 'pads/' +  padName + `/${fileName}`;\n        console.log(`Uploading ${fileName}...`, file);\n        try {\n            // don't wait for the default pad to generate each file\n            // just generate (3) at once and keep going\n            // TODO: we could track progress and show in UI, etc...\n            // await this.bp.apps.client.api.uploadFile(file);\n            this.bp.apps.client.api.uploadFile(file);\n            console.log(`${fileName} uploaded successfully.`);\n        } catch (uploadError) {\n            console.error(`Error uploading ${fileName}: ${uploadError.message}`);\n        }\n    }\n}\n\nfunction getFileType(fileName) {\n    if (fileName.endsWith('.html')) return 'text/html';\n    if (fileName.endsWith('.css')) return 'text/css';\n    if (fileName.endsWith('.js')) return 'application/javascript';\n    return 'text/plain';\n}","export default {\n  \"admin\": {\n    name: 'admin',\n    icon: `desktop/assets/images/icons/icon_profile_64.png`,\n    label: 'Admin',\n    \"onClick\": \"bp.open('admin')\",\n    adminOnly: true,\n  },\n  \"profile\": {\n    \"icon\": \"desktop/assets/images/icons/icon_profile_64.png\",\n    \"label\": \"My Profile\",\n    \"description\": \"Manage your profile and settings\",\n    \"onClick\": \"bp.open('profile')\",\n    \"categories\": [\"social\", \"productivity\"]\n  },\n  \"buddylist\": {\n    \"icon\": \"desktop/assets/images/icons/icon_profile_64.png\",\n    \"label\": \"BuddyList\",\n    \"description\": \"View and manage your contacts\",\n    \"onClick\": \"bp.open('buddylist')\",\n    \"categories\": [\"social\", \"community\"]\n  },\n  \"pad\": {\n    \"icon\": \"desktop/assets/images/icons/icon_pad_64.png\",\n    \"label\": \"Buddy Apps\",\n    \"description\": \"Create hosted Apps for Buddy Pond\",\n    \"onClick\": \"bp.open('pad')\",\n    \"categories\": [\"productivity\", \"creative\", \"community\"]\n  },\n  \"pond\": {\n    \"icon\": \"desktop/assets/images/icons/icon_pond_64.png\",\n    \"label\": \"Ponds\",\n    \"description\": \"Explore shared content or communities\",\n    \"onClick\": \"bp.open('pond')\",\n    \"categories\": [\"community\", \"social\"]\n  },\n  \"file-explorer\": {\n    \"icon\": \"desktop/assets/images/icons/icon_file-explorer_64.png\",\n    \"label\": \"Buddy Files\",\n    \"description\": \"Browse and manage your files\",\n    \"onClick\": \"bp.open('file-explorer')\",\n    \"desktopOnly\": true,\n    \"categories\": [\"files\", \"productivity\"]\n  },\n  \"file-viewer\": {\n    \"icon\": \"desktop/assets/images/icons/icon_file-viewer_64.png\",\n    \"label\": \"File Viewer\",\n    \"description\": \"View files in various formats\",\n    \"onClick\": \"bp.open('file-viewer')\",\n    \"categories\": [\"files\", \"productivity\"]\n  },\n  \"paint\": {\n    \"icon\": \"desktop/assets/images/icons/icon_paint_64.png\",\n    \"label\": \"Paint\",\n    \"description\": \"Create and edit digital artwork\",\n    \"onClick\": \"bp.open('paint')\",\n    \"categories\": [\"art\", \"creative\"]\n  },\n  \"soundrecorder\": {\n    \"icon\": \"desktop/assets/images/icons/icon_soundrecorder_64.png\",\n    \"label\": \"Sound Recorder\",\n    \"description\": \"Record and save audio clips\",\n    \"onClick\": \"bp.open('soundrecorder')\",\n    \"desktopOnly\": true,\n    \"categories\": [\"audio\", \"creative\"]\n  },\n  \"youtube\": {\n    \"icon\": \"desktop/assets/images/icons/icon_interdimensionalcable_64.png\",\n    \"label\": \"Inter Dimensional Cable\",\n    \"description\": \"Watch and browse YouTube videos\",\n    \"onClick\": \"bp.open('youtube')\",\n    \"categories\": [\"entertainment\", \"media\"]\n  },\n  \"camera\": {\n    \"icon\": \"desktop/assets/images/icons/icon_camera_64.png\",\n    \"label\": \"Camera\",\n    \"description\": \"Capture photos or videos\",\n    \"onClick\": \"bp.open('camera')\",\n    \"categories\": [\"media\", \"creative\"]\n  },\n  \"piano\": {\n    \"icon\": \"desktop/assets/images/icons/icon_piano_64.png\",\n    \"label\": \"Piano\",\n    \"description\": \"Play a virtual piano keyboard\",\n    \"onClick\": \"bp.open('piano')\",\n    \"desktopOnly\": true,\n    \"categories\": [\"music\", \"creative\"]\n  },\n  \"fluid-simulation\": {\n    \"icon\": \"desktop/assets/images/icons/icon_fluidsimulation_64.png\",\n    \"label\": \"Fluid Simulation\",\n    \"description\": \"Interact with a fluid dynamics simulation\",\n    \"onClick\": \"bp.open('fluid-simulation')\",\n    \"categories\": [\"creative\", \"entertainment\"]\n  },\n  \"sampler\": {\n    \"icon\": \"desktop/assets/images/icons/icon_midifighter_64.png\",\n    \"label\": \"Sampler\",\n    \"description\": \"Create and mix audio samples\",\n    \"onClick\": \"bp.open('sampler')\",\n    \"categories\": [\"audio\", \"music\", \"creative\"]\n  },\n  \"audio-visual\": {\n    \"icon\": \"desktop/assets/images/icons/icon_visuals_64.png\",\n    \"label\": \"Audio Visuals\",\n    \"description\": \"Experience audio-responsive visuals\",\n    \"onClick\": \"bp.open('audio-visual')\",\n    \"categories\": [\"creative\", \"entertainment\", \"audio\"]\n  },\n  \"coin\": {\n    \"icon\": \"desktop/assets/images/icons/icon_coin_64.png\",\n    \"label\": \"Buddy Coins\",\n    \"description\": \"Manage your virtual currency\",\n    \"onClick\": \"bp.open('coin')\",\n    \"categories\": [\"finance\"]\n  },\n  \"portfolio\": {\n    \"icon\": \"desktop/assets/images/icons/icon_portfolio_64.png\",\n    \"label\": \"Portfolio\",\n    \"description\": \"Track your investments and assets\",\n    \"onClick\": \"bp.open('portfolio')\",\n    \"categories\": [\"finance\"]\n  },\n  \"audio-player\": {\n    \"icon\": \"desktop/assets/images/icons/icon_audio-player_64.png\",\n    \"label\": \"Audio Player\",\n    \"description\": \"Play and manage audio files\",\n    \"onClick\": \"bp.open('audio-player')\",\n    \"categories\": [\"media\", \"audio\"]\n  },\n  \"mantra\": {\n    \"icon\": \"desktop/assets/images/icons/icon_mantra_64.png\",\n    \"label\": \"Mantra\",\n    \"description\": \"Play the Mantra game\",\n    \"categories\": [\"games\"]\n  },\n  \"minesweeper\": {\n    \"icon\": \"desktop/assets/images/icons/icon_minesweeper_64.png\",\n    \"label\": \"Minesweeper\",\n    \"description\": \"Classic Minesweeper puzzle game\",\n    \"categories\": [\"games\"]\n  },\n  \"emulator-nes\": {\n    \"icon\": \"desktop/assets/images/icons/icon_nes_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'nes',\n    \"label\": \"NES\",\n    \"description\": \"Play Nintendo Entertainment System games\",\n    \"options\": { \"context\": \"nes\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-sega\": {\n    \"icon\": \"desktop/assets/images/icons/icon_sega_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'sega',\n    \"label\": \"Sega\",\n    \"description\": \"Play Sega console games\",\n    \"options\": { \"context\": \"sega\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-snes\": {\n    \"icon\": \"desktop/assets/images/icons/icon_snes_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'snes',\n    \"label\": \"SNES\",\n    \"description\": \"Play Super Nintendo games\",\n    \"options\": { \"context\": \"snes\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-atari2600\": {\n    \"icon\": \"desktop/assets/images/icons/icon_atari2600_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'atari2600',\n    \"label\": \"Atari 2600\",\n    \"description\": \"Play Atari 2600 games\",\n    \"options\": { \"context\": \"atari2600\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-n64\": {\n    \"icon\": \"desktop/assets/images/icons/icon_n64_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'n64',\n    \"label\": \"n64\",\n    \"description\": \"Play Nintendo 64 games\",\n    \"options\": { \"context\": \"n64\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"solitaire\": {\n    \"icon\": \"desktop/assets/images/icons/icon_solitaire_64.png\",\n    \"label\": \"Solitaire\",\n    \"description\": \"Classic Solitaire card game\",\n    \"categories\": [\"games\"]\n  },\n  \"globe\": {\n    \"icon\": \"desktop/assets/images/icons/icon_globe_64.png\",\n    \"label\": \"Globe\",\n    \"description\": \"Visualize global network data\",\n    \"categories\": [\"tools\"]\n  },\n  \"hacker-typer\": {\n    \"icon\": \"desktop/assets/images/icons/icon_hacker-typer_64.png\",\n    \"label\": \"Hack Typer\",\n    \"description\": \"Simulate hacking with a typing game\",\n    \"categories\": [\"tools\", \"games\"]\n  },\n  \"hex-editor\": {\n    \"icon\": \"desktop/assets/images/icons/icon_hex-editor_64.png\",\n    \"label\": \"Hex Editor\",\n    \"description\": \"Edit files in hexadecimal format\",\n    \"categories\": [\"tools\", \"productivity\"]\n  },\n  \"maps\": {\n    \"icon\": \"desktop/assets/images/icons/icon_maps_64.png\",\n    \"label\": \"Maps\",\n    \"description\": \"Access mapping and navigation tools\",\n    \"categories\": [\"tools\"]\n  },\n  \"spellbook\": {\n    \"icon\": \"desktop/assets/images/icons/icon_spellbook_64.png\",\n    \"label\": \"Spellbook\",\n    \"description\": \"Manage scripts or commands\",\n    \"categories\": [\"tools\", \"productivity\"]\n  }\n}","/* pad.js - Marak Squires 2024 - BuddyPond Pads */\n// TODO: clean-up this file\nimport renderPadRows from './lib/renderPadRows.js';\nimport savePad from './lib/savePad.js';\nimport buildPad from './lib/buildPad.js';\nimport renderAppList from './lib/renderAppList.js';\n\nexport default class Pad {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        this.icon = '/desktop/assets/images/icons/icon_pad_64.png';\n        return this;\n    }\n\n    // TODO: move to file\n    async help () {\n        return `Pads are a fun way to create and share content with others.\n\n        You may create pads here and such...etc.\n\n        Enjoy!\n\n        `\n    }\n\n    async init() {\n        this.bp.log('Hello from Pad');\n\n        let html = await this.bp.load('/v5/apps/based/pad/pad.html');\n        let css = await this.bp.load('/v5/apps/based/pad/pad.css');\n\n        let slugify = await this.bp.importModule('/v5/apps/based/pad/vendor/slugify.min.js', {}, false);\n        this.slugify = slugify.slugifyDefault;\n\n        this.html = html;\n\n        return 'loaded Pad';\n    }\n\n    // TODO: common function to bind UI\n    // this will *usually* be called inside an open() mutex with window\n    // if app is running headless mode than this is *expected* to be called after init()\n    // TODO: decouple all .bindUI() from .open()...\n    async bindUI () {\n\n    }\n\n    async open() {\n\n        if (!this.padWindow) {\n            this.padWindow = this.bp.apps.ui.windowManager.createWindow({\n                id: 'pad',\n                title: 'Buddy Apps',\n                x: 50,\n                y: 60,\n                width: 1000,\n                height: 600,\n                minWidth: 200,\n                minHeight: 200,\n                icon: this.icon,\n                parent: $('#desktop')[0],\n                content: this.html,\n                resizable: true,\n                minimizable: true,\n                maximizable: true,\n                closable: true,\n                focusable: true,\n                maximized: false,\n                minimized: false,\n                onClose: () => {\n                    this.padWindow = null;\n                }\n            });\n\n            this.tabs = new this.bp.apps.ui.Tabs('.tabs-container', this.padWindow.content);\n\n            this.tabs.onTab(async (tabId) => {\n                // TODO: on tab if tabId = \"pads-home\", \n                // we do need to re-run getPads();....\n                if (tabId === '#pads-home') {\n                    this.myPads = await updateMyPads.call(this);\n                }\n                if (tabId === '#buddy-pads') {\n                    this.renderAppList();\n                    $('.bp-pads-search-input', this.padWindow.content).focus();\n                }\n\n            });\n\n            $('.bp-pads-search-input', this.padWindow.content).on('input', (e) => {\n              // TODO: search for apps\n            });\n\n\n        }\n\n        async function updateMyPads() {\n\n            // TODO: refactor this to separate function\n            // will show myPads by default\n            this.myPads = await this.bp.apps.client.api.getPads();\n            console.log('myPadsmyPads', this.myPads)\n            this.renderPadRows(this.myPads.results);\n        }\n\n        // show the first .tab-content\n        //$('.tab-content').show();\n        $('.tab-content:first', this.padWindow.content).show();\n\n        console.log(this.myPads);\n        if (this.bp.me && this.bp.me !== 'Guest') {\n            $('.loggedOut', this.padWindow.content).flexHide();\n            $('.loggedIn', this.padWindow.content).flexShow();\n        } else {\n            $('.loggedOut', this.padWindow.content).flexShow();\n            $('.loggedIn', this.padWindow.content).flexHide();\n        }\n\n        let userFilesCDN = 'https://files.buddypond.com' + '/' + this.bp.me;\n        let userFilesHome = this.bp.config.host + '/' + this.bp.me;\n\n        $('.userFilesHome', this.padWindow.content).html(userFilesHome);\n        $('.userFilesHome', this.padWindow.content).attr('href', userFilesHome);\n\n        $('.userFilesCDN', this.padWindow.content).html(userFilesCDN);\n        $('.userFilesCDN', this.padWindow.content).attr('href', userFilesCDN);\n\n        let that = this;\n        // Function to update slug and URL preview\n        function updateSlug(value) {\n\n            // Remark, TODO: figure out why \"-\" was not working? Would be nice to have \"-\" in urls?\n            const slugOptions = {\n                lower: true,\n                replacement: '-',\n                remove: /[^A-Za-z0-9_\\-]/g,\n                strict: false\n            };\n\n            // First replace spaces with hyphens in your input\n            let preSlug = value.replace(/\\s+/g, '-');\n\n            // Replace any hypens with underscores\n            preSlug = preSlug.replace(/-+/g, '_');\n\n            let slug = that.slugify(preSlug, slugOptions);\n            //let slug = slugify(value);\n\n            $('.padTitle', that.padWindow.content).val(slug);\n            $('.padUrl', that.padWindow.content).val(`${userFilesCDN}/pads/${slug}`);\n        }\n\n        // Debounce function to limit how often a function can fire\n        const debounce = (func, delay) => {\n            let debounceTimer;\n            return function () {\n                const context = this;\n                const args = arguments;\n                clearTimeout(debounceTimer);\n                debounceTimer = setTimeout(() => func.apply(context, args), delay);\n            };\n        };\n\n        // Event listener for title input\n        $('.padTitle', this.padWindow.content).on('input', debounce(function (e) {\n            $(this).removeClass('error');\n\n            console.log('Input changed:', e.target.value);\n            updateSlug(e.target.value);\n        }, 250)); // Adjust debounce time as needed\n\n        // Optional: Display slugification in action (UX feedback)\n        $('.padTitle', this.padWindow.content).on('input', () => {\n            // Optionally, show some kind of indicator that slug is being generated\n            $('.status-indicator', this.padWindow.content).addClass('active').text('Generating URL...');\n        }).on('input', debounce(() => {\n            $('.status-indicator', this.padWindow.content).removeClass('active').text(''); // Clear indicator when done\n            // update url\n            $('.padUrl', this.padWindow.content).val(`${userFilesHome}/pads/${that.slugify($('.padTitle', that.padWindow.content).val())}`);\n        }, 250));\n\n\n        $('.bp-pad-form', this.padWindow.content).on('submit', async (e) => {\n            e.preventDefault();\n            console.log(`Save pad button clicked`);\n\n\n            // check that     let padTitle = $('#padTitle').val() is not empty\n            let padTitle = $('.padTitle', this.padWindow.content).val();\n            if (!padTitle) {\n                $('.padTitle', this.padWindow.content).addClass('error').attr('placeholder', 'Please enter a name...');\n                return;\n            }\n\n            // disable the save-pad-button to prevent double clicks\n            $('.save-pad-button', this.padWindow.content).prop('disabled', true);\n            // add disabled class to button\n            $('.save-pad-button', this.padWindow.content).addClass('disabled');\n\n            let padSaved = false;\n            let padError;\n            let newPad;\n\n            try {\n                newPad = await this.savePad();\n                padSaved = true;\n            } catch (err) {\n                console.error(err);\n                padError = err;\n            }\n\n            if (padSaved) {\n                console.log('the new pad is ', newPad)\n\n                try {\n                    await this.buildPad(newPad.title);\n\n                } catch (err) {\n                    // alert(`Error building pad: ${err.message}`);\n                    console.error('Error building pad', err);\n                    return;\n                }\n\n                // if not success, show the error\n\n                // now that the pad is created we will need to upload files\n                // show the #pads-upload-files div, which will move user to file-explorer\n                $('#pads-upload-files', this.padWindow.content).show();\n                $('#pads-editor', this.padWindow.content).flexHide();\n\n                // Reloads the My Pads list\n                console.log('getting the pads again');\n                this.myPads = await this.bp.apps.client.api.getPads();\n                console.log('got the pads again', myPads);\n                this.renderPadRows(this.myPads);\n                // set the .bp-pad-container to visible\n                $('.bp-pad-container', this.padWindow.content).flexShow();\n\n                let padTitle = $('#padTitle').val();\n\n                $('.openPadButton', this.padWindow.content).attr('data-context', `/pads/${padTitle}/index.html`);\n                //alert('set')\n\n\n            } else {\n                console.log('Pad not saved', padError);\n                if (padError.message === 'Pad already exists') {\n                    // highlight the title input\n                    $('.padTitle', this.padWindow.content).addClass('error');\n                    $('.status-indicator', this.padWindow.content).addClass('error').text('Pad already exists');\n                }\n            }\n\n            // re-enable the save-pad-button to prevent double clicks\n            $('.save-pad-button', this.padWindow.content).prop('disabled', false);\n            // remove disabled class to button\n            $('.save-pad-button', this.padWindow.content).removeClass('disabled');\n\n\n            return false;\n\n        });\n\n        $('.create-pad-button', this.padWindow.content).on('click', () => {\n            this.tabs.navigateToTab('#pads-editor');\n        });\n\n        this.tabs.showTab('#buddy-pads');\n        this.padWindow.maximize();\n        return this.padWindow;\n\n    }\n\n    editPad(pad) {\n        $('.tab-content', this.padWindow.content).flexHide();\n        $('.pad-code-editor', this.padWindow.content).flexShow();\n    }\n\n\n}\n\nPad.prototype.renderPadRows = renderPadRows;\nPad.prototype.savePad = savePad;\nPad.prototype.buildPad = buildPad;\nPad.prototype.renderAppList = renderAppList;","export default function renderPadRows(myPads) {\n    if (myPads && myPads.length > 0) {\n        // .bp-pad-table , add the tr rows\n        let table = $('.bp-pad-table', this.padWindow.content);\n\n        // clear the table\n        table.empty();\n\n        myPads.forEach((pad) => {\n            // console.log('pad', pad);\n            let tr = document.createElement('tr');\n\n            // set data-title attribute on tr\n            tr.setAttribute('data-title', pad.title);\n\n            // title\n            let td = document.createElement('td');\n            td.innerHTML = pad.title;\n            td.style.fontWeight = 'bold';\n            td.style.minWidth = '100px';\n            tr.appendChild(td);\n\n            // description\n            td = document.createElement('td');\n\n            let padUrl = '/' + pad.owner + '/pads/' + pad.title;\n            let padLink = `<a href=\"${padUrl}\" target=\"_blank\">${padUrl}</a>`;\n            td.innerHTML = padLink;\n\n            tr.appendChild(td);\n\n            // \n            /* Pad visibility is disabled until we implement role logic to bp-files-proxy\n            // The previous API utilized database for fetching pad content, now pad content is proxied through bp-files-proxy to CDN\n            td = document.createElement('td');\n            // create a drop-down select\n            let select = document.createElement('select');\n            select.name = 'visibility';\n            // add options\n            let options = ['Public', 'Private', 'Unlisted'];\n            options.forEach((option) => {\n                let optionElement = document.createElement('option');\n                optionElement.value = option;\n                optionElement.innerHTML = option;\n                console.log(\"comparing\", option, pad.visibility);\n                if (option.toLowerCase() === pad.visibility) {\n                    optionElement.selected = true;\n                }\n                select.appendChild(optionElement);\n            });\n            select.onchange = async (e) => {\n                console.log('visibility changed', e.target.value, pad);\n                pad.visibility = e.target.value.toLowerCase();\n                let profilePadKey = '/' + this.bp.me + '/' + pad.title;\n\n                await this.bp.apps.client.api.updatePad(profilePadKey, pad);\n            };\n            td.appendChild(select);\n            tr.appendChild(td);\n            */\n\n\n            // actions ( edit, delete, view )\n            td = document.createElement('td');\n            td.style.textAlign = 'right';\n            let editButton = document.createElement('button');\n            editButton.classList.add('edit-button');\n            editButton.innerHTML = 'Edit';\n            editButton.onclick = () => {\n                // console.log('edit', pad);\n            }\n            td.appendChild(editButton);\n\n            let deleteButton = document.createElement('button');\n            deleteButton.innerHTML = 'Delete';\n            deleteButton.classList.add('delete-button');\n\n            td.appendChild(deleteButton);\n\n            let viewButton = document.createElement('button');\n            viewButton.innerHTML = 'View';\n            viewButton.classList.add('view-button');\n\n            td.appendChild(viewButton);\n            tr.appendChild(td);\n\n            // TODO: move event handler to separate function / file\n            tr.addEventListener('click', async (e) => {\n                let action;\n                if (e.target.type === 'submit') {\n                    action = e.target.innerHTML;\n                }\n                // alert('clicked ' + action);\n\n                let closestTr = $(e.target).closest('tr');\n                let title = closestTr.attr('data-title');\n                let padUrl = '/' + pad.owner + '/pads/' + pad.title;\n                let padKey = '/' + pad.owner + '/' + pad.title;\n                let relativePath = 'pads/' + pad.title;\n\n                if (action === 'View') {\n                    // console.log('open pad in new window', pad, title);\n                    // open a new window browser window\n                    // TODO: open a new browser window with options ( show url bar, but notinng else )\n                    let win = window.open(padUrl, '_blank');\n                }\n\n                if (action === 'Delete') {\n                    // confirm delete then call api\n\n                    let yesOrNo = confirm('Are you sure you want to delete ' + title + '?');\n\n                    if (yesOrNo) {\n                        // console.log('delete pad', pad, title, padKey);\n\n                        // disable all buttons\n                        $('.ui-button', closestTr).prop('disabled', true);\n                        // add disabled class to button\n                        $('.ui-button', closestTr).addClass('disabled');\n                        try {\n                            await this.bp.apps.client.api.deletePad(padKey);\n\n                        } catch (err) {\n                            console.log('error deleting pad', err);\n                        }\n\n                        try {\n\n                            await this.bp.apps.client.api.removeFile(relativePath);\n                        } catch (err) {\n                            console.log('error deleting pad file', err);\n\n                        }\n\n                        // remove the row from the table\n                        closestTr.remove();\n\n                    }\n\n                    // we need to re-render the table\n                    this.open();\n\n                }\n\n                if (action === 'Edit') {\n                    // open edit window with the pad data\n                    // console.log('edit pad', pad, title);\n                    this.bp.open('file-explorer', { context: '/' + relativePath + '/index.html' });\n                    // set focus\n                    this.bp.apps.ui.windowManager.focusWindow('file-explorer');\n                }\n\n\n            });\n\n            table.append(tr);\n        });\n\n\n\n    } else {\n        // no pads yet\n        $('.bp-pad-container', this.padWindow.content).flexHide();\n    }\n};","export default async function savePad() {\n    // at this point we need to create the Pad in the API\n\n    // check to see if pad with this name already exists\n    let padTitle = $('#padTitle').val();\n    let padKey = '/' + this.bp.me + '/' + padTitle;\n    let padDescription = $('#padDescription').val();    \n    // alert(padName)\n    let thePad;\n    console.log('sending padKey', padKey)\n    try {\n        thePad = await this.bp.apps.client.api.getPad(padKey);\n        console.log(\"got back the pad\", thePad);\n    } catch (err) {\n        console.error('error getting pad', err);\n    }\n    console.log('thePad', thePad);\n    if (!thePad) {\n        console.log('pad is available, creating pad');\n        let padData = {\n            title: padTitle,\n            description: padDescription\n        };\n        let createdPad;\n        try {\n            createdPad = await this.bp.apps.client.api.createPad(padData);\n            console.log('created pad', createdPad);\n        } catch (err) {\n            console.error('error creating pad', err);\n        }\n        return createdPad;\n    } else {\n        console.log('pad already exists, please choose a different name');\n        throw new Error('Pad already exists');\n        return;\n    }\n\n}","import appList from '../../desktop/lib/appList.js';\n\nexport default function renderAppList() {\n    const appContainer = $('.bp-pads-grid');\n    const categoryContainer = $('.bp-pads-category-list');\n    const isMobile = typeof bp !== 'undefined' && bp.isMobile && bp.isMobile();\n\n    // appsInstalled is an object that holds installed apps\n    let appsInstalled = this.bp?.settings?.apps_installed || {};\n\n    // filter out any adminOnly: true apps if not admin\n    if (!this.bp?.me?.isAdmin) {\n        Object.keys(appList).forEach(appName => {\n            if (appList[appName].adminOnly) {\n                delete appList[appName];\n            }\n        });\n    }\n\n    // Get unique categories from appList\n    let categories = new Set();\n    Object.values(appList).forEach(app => {\n        if (app.categories) {\n            app.categories.forEach(category => categories.add(category));\n        }\n    });\n\n    // Populate category buttons\n    // TODO: sort categories alphabetically\n    categories = Array.from(categories).sort();\n    categories.forEach(category => {\n        categoryContainer.append(`\n            <button class=\"bp-pads-category-btn\" data-category=\"${category}\">\n                ${category.charAt(0).toUpperCase() + category.slice(1)}\n            </button>\n        `);\n    });\n\n    // Function to render a single app card\n    function renderAppCard(name, app) {\n        const isInstalled = !!appsInstalled[name];\n        const primaryButtonText = isInstalled ? 'Open' : 'Install';\n        const primaryButtonClass = isInstalled ? 'bp-pads-btn-open' : 'bp-pads-btn-install';\n        const uninstallButton = isInstalled\n            ? `<button class=\"bp-pads-btn bp-pads-btn-uninstall\" data-app=\"${name}\">Uninstall</button>`\n            : '';\n        return `\n            <div class=\"bp-pads-app\" data-app=\"${name}\">\n                <img src=\"${app.icon}\" alt=\"${app.label} icon\" class=\"bp-pads-app-icon\">\n                <div class=\"bp-pads-app-info\">\n                    <h4 class=\"bp-pads-app-label\">${app.label}</h4>\n                    <p class=\"bp-pads-app-description\">${app.description}</p>\n                    <div class=\"bp-pads-app-actions\">\n                        <button class=\"bp-pads-btn ${primaryButtonClass}\" data-app=\"${name}\">${primaryButtonText}</button>\n                        ${uninstallButton}\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n\n    // Function to update button to loading state\n    function setButtonLoading(button, action) {\n        const isInstall = action === 'install';\n        button.addClass('bp-pads-btn-loading');\n        button.text(isInstall ? 'Installing...' : 'Uninstalling...');\n        button.css('cursor', 'wait');\n        // Force repaint to ensure cursor updates\n        button[0].offsetHeight; // Accessing offsetHeight triggers reflow\n    }\n\n    // Function to reset button state\n    function resetButtonState(button, isInstalled) {\n        button.removeClass('bp-pads-btn-loading');\n        button.text(isInstalled ? 'Open' : 'Install');\n        button.removeClass('bp-pads-btn-install bp-pads-btn-open');\n        button.addClass(isInstalled ? 'bp-pads-btn-open' : 'bp-pads-btn-install');\n        button.css('cursor', '');\n    }\n\n    // Function to render apps based on selected category\n    function renderApps(selectedCategory = 'all') {\n        appContainer.empty(); // Clear existing apps\n        let appsToRender = Object.entries(appList);\n\n        // Filter apps by category\n        if (selectedCategory !== 'all' && selectedCategory !== 'installed') {\n            appsToRender = appsToRender.filter(([_, app]) => app.categories && app.categories.includes(selectedCategory));\n        }\n\n        if (selectedCategory === 'installed') {\n            appsToRender = appsToRender.filter(([name]) => appsInstalled[name]);\n        }\n\n        // Filter out desktop-only apps on mobile\n        if (isMobile) {\n            appsToRender = appsToRender.filter(([_, app]) => !app.desktopOnly);\n        }\n\n        // Render apps\n        // sort appsToRender by label\n        appsToRender.sort((a, b) => a[1].label.localeCompare(b[1].label));\n        appsToRender.forEach(([name, app]) => {\n            appContainer.append(renderAppCard(name, app));\n        });\n    }\n\n    // Initial render\n    let currentCategory = 'all';\n    renderApps(currentCategory);\n\n    // Handle category button clicks\n    categoryContainer.on('click', '.bp-pads-category-btn', (ev) => {\n        $('.bp-pads-category-btn').removeClass('bp-pads-category-active');\n        $(ev.target).addClass('bp-pads-category-active');\n        currentCategory = $(ev.target).data('category');\n        renderApps(currentCategory);\n        // scroll to top of app container\n        $(this.padWindow.content).scrollTop(0);\n    });\n\n    // Handle app action button clicks\n    appContainer.on('click', '.bp-pads-btn', async (ev) => {\n        const button = $(ev.target);\n        const appName = button.data('app');\n        const app = appList[appName];\n        if (!app) {\n            console.warn(`App ${appName} not found in appList`);\n            return;\n        }\n\n        const isInstalled = !!appsInstalled[appName];\n        if (button.hasClass('bp-pads-btn-install')) {\n            // Install action\n            console.log(`Stub: Installing app ${appName}`);\n            setButtonLoading(button, 'install');\n            // this.bp.apps.desktop.showLoadingProgressIndicator(); // Use existing method\n            // Simulate async operation (replace with actual addApp implementation)\n            await this.bp.apps.desktop.addApp(appName, app);\n            appsInstalled[appName] = app; // Update local state\n            resetButtonState(button, true);\n            // this.bp.apps.desktop.hideLoadingProgressIndicator();\n            // Re-render app card to show Uninstall button\n            $(`.bp-pads-app[data-app=\"${appName}\"]`).replaceWith(renderAppCard(appName, app));\n        } else if (button.hasClass('bp-pads-btn-open')) {\n            // Open action\n            console.log(`Stub: Opening app ${appName}`);\n            //if (app.onClick) {\n            try {\n                // eval(app.onClick); // Note: eval is used for simplicity; replace with safer execution\n                console.log(`Executing onClick for ${appName}`, app);\n\n                if (app.app) {\n                    // may have custom defined app name with context\n                    // for example, emulator app uses this to open with context of system\n                    this.bp.open(app.app, {\n                        context: app.context || {},\n                    });\n\n                } else {\n\n                    this.bp.open(appName);\n                }\n\n            } catch (e) {\n                console.error(`Error executing onClick for ${appName}:`, e);\n            }\n        } else if (button.hasClass('bp-pads-btn-uninstall')) {\n            // Uninstall action\n            console.log(`Stub: Uninstalling app ${appName}`);\n            setButtonLoading(button, 'uninstall');\n            // this.bp.apps.desktop.showLoadingProgressIndicator();\n            // Simulate async operation (replace with actual removeApp implementation)\n            // remove the open button immediately\n            // $(`.bp-pads-app[data-app=\"${appName}\"]`).replaceWith(renderAppCard(appName, app)); // Update UI to show loading state\n            let closestOpenButton = button.parent().find('.bp-pads-btn-open');\n            console.log(closestOpenButton)\n            closestOpenButton.remove();\n            await this.bp.apps.desktop.removeApp(appName, app);\n            delete appsInstalled[appName]; // Update local state\n            resetButtonState(button, false);\n            // this.bp.apps.desktop.hideLoadingProgressIndicator();\n            // Re-render app card to hide Uninstall button\n            $(`.bp-pads-app[data-app=\"${appName}\"]`).replaceWith(renderAppCard(appName, app));\n        }\n    });\n}"],"names":["defaultFiles","getFileType","fileName","endsWith","appList","admin","name","icon","label","onClick","adminOnly","profile","description","categories","buddylist","pad","pond","desktopOnly","paint","soundrecorder","youtube","camera","piano","sampler","coin","portfolio","mantra","minesweeper","app","context","options","solitaire","globe","maps","spellbook","Pad","constructor","bp","this","help","init","log","html","load","slugify","importModule","slugifyDefault","bindUI","open","async","updateMyPads","myPads","apps","client","api","getPads","console","renderPadRows","results","padWindow","ui","windowManager","createWindow","id","title","x","y","width","height","minWidth","minHeight","parent","$","content","resizable","minimizable","maximizable","closable","focusable","maximized","minimized","onClose","tabs","Tabs","onTab","tabId","call","renderAppList","focus","on","e","show","me","flexHide","flexShow","userFilesCDN","userFilesHome","config","host","attr","that","debounce","func","delay","debounceTimer","args","arguments","clearTimeout","setTimeout","apply","removeClass","target","value","preSlug","replace","slug","lower","replacement","remove","strict","val","updateSlug","addClass","text","preventDefault","prop","padError","newPad","padSaved","savePad","err","error","buildPad","padTitle","message","navigateToTab","showTab","maximize","editPad","prototype","length","table","empty","forEach","tr","document","createElement","setAttribute","td","innerHTML","style","fontWeight","appendChild","padUrl","owner","padLink","textAlign","editButton","classList","add","onclick","deleteButton","viewButton","addEventListener","action","type","closestTr","closest","padKey","relativePath","window","confirm","deletePad","removeFile","focusWindow","append","thePad","padDescription","getPad","Error","createdPad","padData","createPad","padName","template","fileContent","Object","entries","defaultPadFiles","blob","Blob","file","File","lastModified","Date","filePath","uploadFile","uploadError","appContainer","categoryContainer","isMobile","appsInstalled","settings","apps_installed","isAdmin","keys","appName","Set","renderAppCard","isInstalled","primaryButtonText","primaryButtonClass","uninstallButton","setButtonLoading","button","isInstall","css","offsetHeight","resetButtonState","renderApps","selectedCategory","appsToRender","filter","_","includes","sort","a","b","localeCompare","values","category","Array","from","charAt","toUpperCase","slice","currentCategory","ev","data","scrollTop","hasClass","desktop","addApp","replaceWith","closestOpenButton","find","removeApp","warn"],"mappings":"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"}