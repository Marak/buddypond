class t{constructor(t,e={}){return this.bp=t,this.youtubeWindow=null,this.player=null,this}async init(){this.html=await this.bp.load("/v5/apps/based/youtube/youtube.html");let t=await this.bp.importModule("/v5/apps/based/youtube/data/playlist.js",{},!1);this.playlist=t.default,window.YT?this.apiReady=!0:(await this.bp.appendScript("https://www.youtube.com/iframe_api"),window.onYouTubeIframeAPIReady=()=>{this.apiReady=!0})}async close(){this.player&&(this.player.destroy(),this.player=null),this.youtubeWindow&&(this.youtubeWindow=null)}async open(t={}){if(this.youtubeWindow)return void(this.player&&t.context&&this.player.loadVideoById(t.context));for(this.youtubeWindow=this.bp.apps.ui.windowManager.createWindow({id:"youtube-window",title:"YouTube",x:50,y:100,width:600,height:480,minWidth:200,minHeight:200,parent:$("#desktop")[0],icon:"/desktop/assets/images/icons/icon_interdimensionalcable_64.png",content:this.html,resizable:!0,minimizable:!0,maximizable:!0,closable:!0,focusable:!0,maximized:!1,minimized:!1,onClose:()=>this.close()});!this.apiReady;)await new Promise((t=>setTimeout(t,100)));$(".orb-holder",this.youtubeWindow.content).on("click",(()=>{this.playRandomVideo()}));let e=t.context||this.playlist[Math.floor(Math.random()*this.playlist.length)];this.player=new YT.Player("youtube-player",{height:"390",width:"640",videoId:e,playerVars:{autoplay:1,controls:1},events:{onReady:this.onPlayerReady,onStateChange:t=>this.onPlayerStateChange(t),onError:t=>this.onPlayerError(t)},origin:window.location.origin})}onPlayerReady(t){console.log("YouTube Player Ready",t)}onPlayerStateChange(t){t.data===YT.PlayerState.ENDED&&this.playRandomVideo()}onPlayerError(t){console.warn("YouTube Player Error:",t);([100,101,150].includes(t.data)||2===t.data)&&(console.warn("Video unavailable, selecting a new one..."),this.playRandomVideo())}playRandomVideo(){if(!this.player||!this.playlist)return;let t=this.playlist[Math.floor(Math.random()*this.playlist.length)];this.player.loadVideoById(t)}}export{t as default};
//# sourceMappingURL=youtube.js.map
