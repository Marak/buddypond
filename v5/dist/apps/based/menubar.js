function e(e){return[{label:'<span id="me_title" class="me_title">Welcome - You look nice today!</span>',submenu:[{label:'<span class="desktop-only">We are stoked to be your Buddy</span>'},{label:"Buddy Apps",closeMenu:!0,click:()=>e.open("pad")},{label:"Edit Profile",closeMenu:!0,click:()=>e.open("profile")},{label:'<span class="loggedOut">Login</span>',click:()=>e.open("buddylist")},{label:'<span class="loggedIn">Logout</span>',click:()=>{e.logout&&e.logout(),e.apps.ui.windowManager.windows.forEach((e=>{"buddylist"!==e.app||"buddy"!==e.type&&"pond"!==e.type||e.close(),"pond"===e.app&&e.close()}))}}]},{label:"Window",className:"desktop-only",submenu:[{label:"Full Screen",click:()=>e.apps.ui.toggleFullScreen()},{label:"Hide All Windows",click:()=>e.apps.ui.windowManager.minimizeAllWindows()}]},{label:'<span style="display:flex;">$GBP Coin Balance: <span id="menu-bar-coin-balance" class="odometer">0</span></span>',submenu:[{label:"View Coin Balance",closeMenu:!0,click:()=>e.open("portfolio")},{label:"Send Coins",closeMenu:!0,click:()=>e.open("portfolio",{context:"#portfolio-transfer"})}]},{label:'\n              <span class="loggedIn">Reward in: <span id="menu-bar-coin-reward-coindown" class="countdown-date">0:59</span></span>\n              \x3c!-- <span class="loggedOut">Login to get Coin Rewards</span> --\x3e\n            '},{label:"",flex:1,className:"desktop-only"},{label:'\n<div class="dropdown-wrapper desktop-only float_right select-playlist-dropdown-menu">\n  <span class="icon trigger" title="Select Music Playlist">\n    <i class="fa-duotone fa-regular fa-music"></i> Select Music Playlist\n  </span>\n  <ul class="dropdown-menu" style="display: none;">\n    <li data-value="1397230333">Buddy House 0 (33 Tracks)</li>\n    <li data-value="1397493787">Buddy House 1 (10 Tracks)</li>\n    <li data-value="1427128612">Buddy House 2 (10 Tracks)</li>\n  </ul>\n</div>\n    '},{label:'\n<div class="dropdown-wrapper desktop-settings-dropdown-menu">\n  <span class="icon trigger" title="Desktop Settings">\n    <i class="fa-duotone fa-regular fa-desktop"></i> Desktop Settings\n  </span>\n  <ul class="dropdown-menu" style="display: none;">\n    <li data-value="open">Open Desktop Settings</li>\n    <li data-value="matrix">Matrix Wallpaper</li>\n    <li data-value="nyancat">Nyan Cat Wallpaper</li>\n    <li data-value="ripples">Ripples Wallpaper</li>\n    <li data-value="urlWallpaper">Set Wallpaper to Url</li>\n  </ul>\n</div>\n    '},{label:'<span title="View Source Code">\n    <i class="fa-duotone fa-regular fa-code"></i> Source Code\n  </span>',click:()=>{window.open("https://github.com/buddypond/buddypond","_blank")}},{label:'<span class="selectLightMode float_right"><i class="fa-duotone fa-regular fa-sun" data-mode="Light" title="Light Mode"></i><i class="fa-duotone fa-regular fa-moon" data-mode="Dark" title="Dark Mode"></i></span>'},{label:'\n    <div class="volume">\n    <span class="volumeIcon volumeToggle volumeFull">ðŸ”Š</span>\n    <span class="volumeIcon volumeToggle volumeMuted">ðŸ”‡</span>\n    \n    \x3c!-- <input type="range" min="0" max="100" value="100" class="volumeSlider"> --\x3e\n    </div>\n    ',click:()=>{console.log("Volume toggle clicked"),e.apps.desktop.toggleMute()}},{label:'\n    <span class="" id="clock"></span>\n    '}]}class n{constructor(e,n={}){this.bp=e,this.options=n,this.menus={},this.currentMenuData=[],this.menuBarElement=null}async init(){await this.bp.appendCSS("/v5/apps/based/menubar/menubar.css"),this.bp.on("auth::logout","reset-menu",(()=>$(".me_title").html("Sign In"))),this.load()}load(n={},t=document.body){this.currentMenuData=e(this.bp),this.renderMenu(t)}setDefaultMenu(){this.currentMenuData=e(this.bp),this.renderMenu()}setMenu(e,n){e?n?this.menus[e]=n:delete this.menus[e]:this.currentMenuData=n||[];const t=this.currentMenuData.length?this.currentMenuData:Object.values(this.menus).flat();console.log("new menuData",t),this.renderMenu(void 0,n)}renderMenu(e=document.body,n=this.currentMenuData){this.menuBarElement&&this.menuBarElement.remove(),this.menuBarElement=new t(n).createMenu(),e.appendChild(this.menuBarElement),this.bp.isMobile()&&$(".desktop-only").remove(),this.bp.settings.active_theme?$(".selectTheme",this.menuBarElement).val(this.bp.settings.active_theme):$(".selectTheme",this.menuBarElement).val("Dark"),!1===this.bp.settings.audio_enabled?($(".volumeFull").hide(),$(".volumeMuted").show()):($(".volumeFull").show(),$(".volumeMuted").hide()),$(".selectLightMode i",this.menuBarElement).on("click",(function(e){let n=$(e.target).data("mode");bp.apps.themes.applyTheme(n)})),$(".icon.trigger").on("click",(function(e){e.stopPropagation(),$(this).siblings(".dropdown-menu").slideToggle(200)})),$(".desktop-settings-dropdown-menu li").on("click",(function(){const e=$(this).data("value");if($(this).text(),$(this).parent().slideUp(200),console.log("Selected:",e),e)if("urlWallpaper"!==e){if("open"===e)return bp.open("profile",{context:"themes"}),void this.menuBarElement.closeMobileMenu();bp.set("wallpaper_url",null),bp.set("wallpaper_name",e)}else bp.apps.wallpaper.setWallpaper()})),$(".select-playlist-dropdown-menu li").on("click",(function(){const e=$(this).data("value");$(this).text(),$(this).parent().slideUp(200),console.log("Selected:",e),$("#soundcloudiframe").remove(),$("#soundcloudplayer").html(""),bp.apps.soundcloud&&(bp.apps.soundcloud.soundCloudEmbeded=!1),bp.open("soundcloud",{playlistID:e})})),$(document).on("click",(function(e){$(e.target).closest(".dropdown-wrapper").length||$(".dropdown-menu").slideUp(200)}));let l=$("#menu-bar-coin-reward-coindown");function a(){const e=new Date(Date.now()+6e4);bp.apps.ui.countdownManager.startCountdown(l,e,(function e(n){bp.apps.rewards.requestReward(),setTimeout((()=>{const t=new Date(Date.now()+6e4);bp.apps.ui.countdownManager.startCountdown(n,t,e)}),10)}))}this.bp.qtokenid?a():($(".loggedIn").flexHide(),this.bp.on("auth::qtoken","start-rewards-timer",(()=>{a()})))}}class t{constructor(e,n={}){this.menuTemplate=e,this.menuBarElement=null,this.id=n.id||"menu-bar"}createMenu(){return this.menuBarElement=document.createElement("div"),this.menuBarElement.classList.add("menu-bar"),this.menuBarElement.classList.add("desktop-menu-bar"),this.menuBarElement.id=this.id,this.menuTemplate.forEach((e=>this.createMenuItem(e))),this.menuBarElement.classList.add("responsive-ready"),this.addGlobalEventListeners(),this.menuBarElement}createMenuItem(e){const n=document.createElement("div");if(n.classList.add("menu-item"),n.innerHTML=e.label,e.flex&&(n.style.flex=e.flex),e.className&&n.classList.add(e.className),e.click&&(n.onclick=n=>{n.stopPropagation(),e.click(),e.closeMenu&&this.closeMobileMenu()}),e.submenu){const t=this.createSubMenu(e.submenu);n.appendChild(t);window.matchMedia("(max-width: 1000px)").matches?n.addEventListener("click",(e=>{e.stopPropagation(),t.classList.toggle("open")})):(n.addEventListener("mouseover",(()=>t.style.display="block")),n.addEventListener("mouseleave",(()=>t.style.display="none")))}this.menuBarElement.appendChild(n)}createSubMenu(e){const n=document.createElement("div");return n.classList.add("submenu"),e.forEach((e=>{const t=document.createElement("div");if(t.classList.add("submenu-item"),t.innerHTML=e.label,e.click&&(t.onclick=n=>{n.stopPropagation(),e.click(),e.closeMenu&&this.closeMobileMenu()}),e.submenu){const n=this.createSubMenu(e.submenu);t.appendChild(n),t.addEventListener("mouseover",(()=>n.style.display="block")),t.addEventListener("mouseleave",(()=>n.style.display="none"))}n.appendChild(t)})),n}addGlobalEventListeners(){document.addEventListener("click",(e=>{this.menuBarElement.contains(e.target)||this.closeAllSubmenus()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.closeAllSubmenus()}))}closeAllSubmenus(){document.querySelectorAll(".submenu").forEach((e=>e.style.display="none"))}closeMobileMenu(){const e=$(this.menuBarElement);e.hasClass("mobile-active")&&e.animate({left:"-100%"},300,(()=>{e.removeClass("mobile-active")}))}}export{n as default};
//# sourceMappingURL=menubar.js.map
