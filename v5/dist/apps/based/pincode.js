class a{constructor(a,s={}){this.bp=a,this.options=s}async init(){return this.html=await this.bp.load("/v5/apps/based/pincode/pincode.html"),await this.bp.load("/v5/apps/based/pincode/pincode.css"),"loaded password dialog"}async open(){if(!this.opened){this.opened=!0,$(document.body).append(this.html),$(".password-form");const a=$(".email-input"),s=$(".password-main"),o=$(".password-confirm"),t=$(".form-status");bp.apps.buddylist&&bp.apps.buddylist.data.profileState&&bp.apps.buddylist.data.profileState.email&&a.val(bp.apps.buddylist.data.profileState.email);const e={email:$(".email-error"),password:$(".password-error"),confirm:$(".confirm-error")};$(".save-btn").on("click",(async()=>{e.email.text(""),e.password.text(""),e.confirm.text(""),t.text(""),s.removeClass("error"),o.removeClass("error");const d=a.val().trim(),r=s.val().trim(),i=o.val().trim();if(!r)return e.password.text("Password is required."),void s.addClass("error");if(i!==r)return e.confirm.text("Passwords do not match."),void o.addClass("error");try{const a=await buddypond.updateAccount({buddyname:this.bp.me,password:r,email:d||void 0});console.log("Password set successfully",a),$(".password-overlay").hide(),bp.apps.buddylist&&bp.apps.buddylist.data.profileState&&bp.apps.buddylist.data.profileState.email&&(bp.apps.buddylist.data.profileState.email=d)}catch(a){console.error("Failed to save password:",a),t.text("Failed to update account. Please try again.")}})),$(".cancel-btn").on("click",(()=>{$(".password-overlay").hide()})),window.showPasswordDialog=()=>$(".password-overlay").show(),showPasswordDialog(),a.val().trim()?s.focus():a.focus()}}}export{a as default};
//# sourceMappingURL=pincode.js.map
