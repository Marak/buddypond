class t{constructor(t,e,r="https://example.com"){return this.bp=t,this.container=e,this.currentUrl=r,this.iframe=null,this.history=[r],this.currentIndex=0,this.baseUrl="",this.init(),this}init(){let t=`\n            <div class="bp-browserwindow-container">\n                <div class="bp-browserwindow-toolbar">\n                    <div class="bp-browserwindow-navigation">\n                        <button class="bp-browserwindow-nav-btn back" disabled>‚Üê</button>\n                        <button class="bp-browserwindow-nav-btn forward" disabled>‚Üí</button>\n                        <button class="bp-browserwindow-nav-btn reload">‚Üª</button>\n                    </div>\n                    <div class="bp-browserwindow-addressbar">\n                        <span class="ssl-indicator">üîí</span>\n                        <input type="text" class="bp-browserwindow-url" value="${this.currentUrl}">\n                    </div>\n                </div>\n                <div class="bp-browserwindow-content">\n                    <iframe src="about:blank" style="width:100%; height:100%; border:none;"></iframe>\n                </div>\n            </div>\n        `,e=document.createElement("div");e.className="bp-browserwindow",e.innerHTML=t,this.container.append(e),this.iframe=this.container.querySelector("iframe"),this.setupEventListeners(),this.navigate(this.currentUrl),this.bp.on("browser::setAddressBar","update-address-bar-value",(t=>{this.setAddressBar(t)}))}setBaseUrl(t){this.baseUrl=t}setContent(t,e=1){try{const e=this.iframe.contentDocument||this.iframe.contentWindow.document;e.open();const r=`<base href="${this.baseUrl}" target="_blank">`+t;e.write(r),e.close()}catch(r){console.log("Error setting content:",r),this.iframe.src="about:blank",e<9001?setTimeout((()=>{this.setContent(t,e+1)}),100):console.error("Failed to set content after 2 attempts")}}setupEventListeners(){const t=this.container.querySelector(".bp-browserwindow-url"),e=this.container.querySelector(".bp-browserwindow-nav-btn.back"),r=this.container.querySelector(".bp-browserwindow-nav-btn.forward"),s=this.container.querySelector(".bp-browserwindow-nav-btn.reload");t.addEventListener("keypress",(e=>{"Enter"===e.key&&this.navigate(t.value)})),e.addEventListener("click",(()=>this.goBack())),r.addEventListener("click",(()=>this.goForward())),s.addEventListener("click",(()=>this.reload()))}navigate(t){t.startsWith("http://")||t.startsWith("https://")||(t="https://"+t),this.currentIndex<this.history.length-1&&(this.history=this.history.slice(0,this.currentIndex+1)),this.history.push(t),this.currentIndex=this.history.length-1,this.currentUrl=t,this.updateAddressBar(),this.updateNavigationButtons()}goBack(){this.currentIndex>0&&(this.currentIndex--,this.currentUrl=this.history[this.currentIndex],this.updateAddressBar(),this.updateNavigationButtons())}goForward(){this.currentIndex<this.history.length-1&&(this.currentIndex++,this.currentUrl=this.history[this.currentIndex],this.updateAddressBar(),this.updateNavigationButtons())}reload(){this.iframe.src=this.currentUrl}setAddressBar(t){this.container.querySelector(".bp-browserwindow-url").value=t}updateAddressBar(){this.container.querySelector(".bp-browserwindow-url").value=this.currentUrl,this.iframe.src=this.currentUrl}updateNavigationButtons(){const t=this.container.querySelector(".bp-browserwindow-nav-btn.back"),e=this.container.querySelector(".bp-browserwindow-nav-btn.forward");t.disabled=this.currentIndex<=0,e.disabled=this.currentIndex>=this.history.length-1}getHistory(){return{history:this.history,currentIndex:this.currentIndex,currentUrl:this.currentUrl}}}class e{constructor(t,e={}){return this.bp=t,this}async init(){return this.bp.log("Hello from Example"),await this.bp.load("/v5/apps/based/browser/browser.css"),"loaded Example"}async open(){let e=this.bp.apps.ui.windowManager.createWindow({id:"browser-window",title:"Hello World",x:50,y:100,width:400,height:300,minWidth:200,minHeight:200,parent:$("#desktop")[0],content:"",resizable:!0,minimizable:!0,maximizable:!0,closable:!0,focusable:!0,maximized:!1,minimized:!1});this.browser=new t(this.bp,e.content,"https://example.com")}}e.prototype.BrowserWindow=t;export{e as default};
//# sourceMappingURL=browser.js.map
