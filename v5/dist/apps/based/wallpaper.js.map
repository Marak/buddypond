{"version":3,"file":"wallpaper.js","sources":["../../../apps/based/wallpaper/WallpaperManager.js","../../../apps/based/wallpaper/setWallpaper.js","../../../apps/based/wallpaper/removeWallpaper.js","../../../apps/based/wallpaper/wallpaper.js"],"sourcesContent":["import setWallpaper from './setWallpaper.js';\nimport removeWallpaper from './removeWallpaper.js';\n\nexport default class WallpaperManager {\n    constructor(bp) {\n        this.bp = bp;\n        this.canvas = null;\n        this.label = 'Wallpaper';\n        this.settings = {};\n        this.init = false;\n        this.width = 0;\n        this.height = 0;\n        this.wallpapers = {};\n        this.paused = false;\n        this.active = null;\n        this._wallpapers = {\n            'solid': {\n                label: 'Solid',\n                src: ['/v5/apps/based/wallpaper/wallpapers/solid.js']\n            },\n            'matrix': {\n                label: 'Matrix',\n                src: ['/v5/apps/based/wallpaper/wallpapers/matrix.js']\n            },\n            'nyancat': {\n                label: 'Nyan Cat',\n                src: ['/v5/apps/based/wallpaper/wallpapers/nyancat.js']\n            },\n            'ripples': {\n                label: 'Ripples',\n                src: [\n                    '/v5/apps/based/wallpaper/wallpapers/ripples/ripples.js'\n                ]\n            },\n            'url': {\n                label: 'URL',\n                src: ['/v5/apps/based/wallpaper/wallpapers/url.js']\n            }\n        };\n\n\n        bp.on('settings::wallpaper_color', 'update-wallpaper-bg-color', (color) => {\n            if (this.wallpapers[this.active]) {\n                this.wallpapers[this.active].changeColor(color);\n            }\n        });\n\n    }\n\n    async load(params, next) {\n        try {\n            this.resizeCanvasToWindow();\n            // console.log('Loading wallpapers', this.bp.settings);\n            // check to see if this.settings.wallpaper_url is set\n            if (this.bp.settings.wallpaper_url) {\n                this.setWallpaper(this.bp.settings.wallpaper_url);\n            } else {\n                this.active = this.bp.settings.wallpaper_name || 'solid';\n                this.start();\n            }\n            this.setupEventListeners();\n            next();\n        } catch (error) {\n            console.error('Error loading assets:', error);\n        }\n    }\n\n    resizeCanvasToWindow() {\n        let canvas = document.getElementById('c');\n        canvas.height = window.innerHeight;\n        canvas.width = window.innerWidth;\n        this.height = window.innerHeight;\n        this.width = window.innerWidth;\n    }\n\n    async start() {\n        this.paused = false;\n        this.resizeCanvasToWindow();\n\n        if (!this.wallpapers[this.active]) {\n            let remoteScript = this._wallpapers[this.active].src;\n            // console.log('Loading wallpaper:', this.active, remoteScript);\n            let wp = await this.bp.importModule(remoteScript[0], {}, false);\n            this.wallpapers[this.active] = new wp.default('c');\n            // check for load function, call if required\n            // Remark: This is a bit of a \"sub-app\" pattern,\n            // it might be better to have each wallpaper be it's own app\n            this.wallpapers[this.active].start(this.bp);\n\n        } else {\n            this.wallpapers[this.active].start(this.bp);\n        }\n    }\n\n    pause() {\n        this.paused = true;\n        this.wallpapers[this.active].pause();\n    }\n\n    stop() {\n        if (this.wallpapers[this.active] && this.wallpapers[this.active].stop) {\n            this.wallpapers[this.active].stop();\n        }\n        this.clear();\n    }\n\n    clear() {\n        let canvas = document.getElementById('c');\n        let ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n\n    loadRemoteAssets(assets, callback) {\n        // Simulate asset loading\n        console.log(`Loading assets: ${assets.join(', ')}`);\n        setTimeout(callback, 1000); // Simulating async loading\n    }\n\n    setupEventListeners() {\n        window.addEventListener('resize', (e) => {\n            if (e.target !== window) return;\n            this.resizeCanvasToWindow();\n            if (this.wallpapers[this.active]) {\n                this.wallpapers[this.active].resize();\n            }\n        });\n\n        $('.pauseWallpaper').on('click', () => {\n            if (this.paused) {\n                this.start();\n                $('.pauseWallpaper').html('Pause Wallpaper');\n            } else {\n                $('#wallpaper').fadeOut('slow');\n                $('.pauseWallpaper').html('Resume Wallpaper');\n                this.pause();\n            }\n        });\n    }\n}\n\nWallpaperManager.prototype.setWallpaper = setWallpaper;\nWallpaperManager.prototype.removeWallpaper = removeWallpaper;","export default function setWallpaper (url) {\n\n    if (!url) {\n        url = prompt('Enter the URL for the wallpaper');\n    }\n\n    if (!url) {\n        console.error('No URL provided for wallpaper');\n        return;\n    }\n\n    // set the #wallpaper element to the url\n    let wallpaper = document.getElementById('wallpaper');\n    wallpaper.src = url;\n\n    // show the element\n    wallpaper.style.display = 'block';\n\n    // save the wallpaper setting in local storage\n    this.bp.set('wallpaper_url', url);\n\n    this.wallpaperManager.stop();\n\n}","export default function removeWallpaper () {\n\n\n    // set the #wallpaper element to the url\n    let wallpaper = document.getElementById('wallpaper');\n    wallpaper.src = '';\n    // hide the wallpaper\n    wallpaper.style.display = 'none';\n\n    // save the wallpaper setting in local storage\n    this.bp.set('wallpaper_url', null);\n\n    this.bp.apps.wallpaper.wallpaperManager.stop();\n\n}","import WallpaperManager from './WallpaperManager.js';\n\nexport default class Wallpaper {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        return this;\n    }\n\n    async init() {\n        const wallpaperManager = new WallpaperManager(this.bp);\n        wallpaperManager.load({}, () => {\n            //console.log('Wallpapers loaded')\n        });\n        this.wallpaperManager = wallpaperManager;\n        this.bp.on('settings::wallpaper_name', 'update-wallpaper', function (data) {\n            wallpaperManager.stop();\n            console.log(`Wallpaper changed to ${data}`);\n            wallpaperManager.active = data;\n            wallpaperManager.start();\n        });\n        return 'loaded Wallpaper';\n    }\n\n    setWallpaper(url) {\n        this.wallpaperManager.setWallpaper(url);\n    }\n\n    removeWallpaper() {\n        this.wallpaperManager.removeWallpaper();\n    }\n}"],"names":["WallpaperManager","constructor","bp","this","canvas","label","settings","init","width","height","wallpapers","paused","active","_wallpapers","solid","src","matrix","nyancat","ripples","url","on","color","changeColor","load","params","next","resizeCanvasToWindow","wallpaper_url","setWallpaper","wallpaper_name","start","setupEventListeners","error","console","document","getElementById","window","innerHeight","innerWidth","remoteScript","wp","importModule","default","pause","stop","clear","getContext","clearRect","loadRemoteAssets","assets","callback","log","join","setTimeout","addEventListener","e","target","resize","$","html","fadeOut","prototype","prompt","wallpaper","style","display","set","wallpaperManager","removeWallpaper","apps","Wallpaper","options","data"],"mappings":"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"}