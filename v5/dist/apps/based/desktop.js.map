{"version":3,"file":"desktop.js","sources":["../../../apps/based/desktop/lib/Folder.js","../../../apps/based/desktop/lib/File.js","../../../apps/based/desktop/lib/shortcuts/addShortCut.js","../../../apps/based/desktop/lib/shortcuts/arrangeShortCuts.js","../../../apps/based/desktop/lib/addFolder.js","../../../apps/based/desktop/lib/shortcuts/removeShortCut.js","../../../apps/based/desktop/lib/shortcuts/createShortCut.js","../../../apps/based/desktop/lib/shortcuts/renameShortCut.js","../../../apps/based/desktop/lib/appList.js","../../../apps/based/desktop/lib/apps/addApp.js","../../../apps/based/desktop/lib/apps/removeApp.js","../../../apps/based/desktop/lib/contextmenu/setupContextMenu.js","../../../apps/based/desktop/lib/contextmenu/showContextMenu.js","../../../apps/based/desktop/lib/viewSource.js","../../../apps/based/desktop/lib/defaultDesktopShortcuts.js","../../../apps/based/desktop/desktop.js"],"sourcesContent":["export default class Folder {\n    constructor(data, options = {}) {\n        this.data = data;\n        this.parentElement = options.parentElement;\n        this.desktop = options.desktop;\n        this.depth = options.depth;\n        this.options = options;\n    }\n\n    render(app = {}) {\n    \n        app = this.data;\n        // Create the shortcut element\n        const folderDiv = document.createElement('div');\n        folderDiv.className = `folder ${app.class || ''}`;\n\n        if (this.depth > 1) {\n            folderDiv.classList.add(`hidden`);\n        }\n        folderDiv.classList.add('icon', 'shortcut');   \n        const anchor = document.createElement('a');\n        // anchor.href = app.href || `#icon_dock_${app.name}`;\n\n        const image = document.createElement('img');\n        image.className = 'bp-desktop-icon';\n        image.loading = 'lazy';\n        image.src = 'desktop/assets/images/icons/icon_folder_64.png';\n\n        const title = document.createElement('span');\n        title.className = 'title';\n        title.textContent = app.label || app.name || app.id;\n\n        anchor.appendChild(image);\n        anchor.appendChild(title);\n        folderDiv.appendChild(anchor);\n\n        // folderDiv.onclick = () => this.openFolder(); // Placeholder for folder opening logic\n\n        $(folderDiv).draggable({\n            containment: 'parent' // Confine dragging within the parent container\n        });\n\n        // folderDiv click handler\n        folderDiv.addEventListener('mousedown', (e) => {\n           this.options.onOpen();\n        });\n\n        this.parentElement.appendChild(folderDiv);\n\n        // Recursively render each child in this folder\n        // this.data.children.forEach(child => this.desktop.renderNode(child, folderDiv, this.depth + 1));\n    }\n\n    open () {\n        // Logic to open the folder\n           this.options.onOpen();\n    }\n}\n","\n\nexport default class File {\n    constructor(data, parentElement, desktop, depth) {\n        this.data = data;\n        console.log(\"FIKLE DATA\", data);\n        this.parentElement = parentElement;\n        this.desktop = desktop;\n        this.options = {};\n        this.depth = depth;\n    }\n\n    render(app = {}) {\n\n        app = this.data;\n\n        // Create the shortcut element\n        const el = document.createElement('div');\n        el.className = `icon shortcut ${app.class || ''}`;\n\n        if (this.depth > 1) {\n            el.classList.add(`hidden`);\n        }\n\n        el.classList.add('icon', 'shortcut');   \n\n\n        const anchor = document.createElement('a');\n        // anchor.href = app.href || `#icon_dock_${app.name}`;\n\n        const image = document.createElement('img');\n        image.className = 'bp-desktop-icon';\n        image.loading = 'lazy';\n        image.src = app.icon;\n\n        const title = document.createElement('span');\n        title.className = 'title';\n        title.textContent = app.label || app.name || app.id;\n\n        anchor.appendChild(image);\n        anchor.appendChild(title);\n        el.appendChild(anchor);\n\n        // Adding onClick event to the .icon container\n        el.addEventListener('click', this.options.onClick);\n\n\n\n\n        // Apply jQuery UI draggable if enabled\n        if (this.enableShortcutDragging) {\n            $(el).draggable({\n                containment: 'parent' // Confine dragging within the parent container\n            });\n        }\n\n\n        this.parentElement.appendChild(el);\n\n\n        // Recursively render each child in this folder\n    }\n}\n","export default function addShortCut(app, options = {}, parent) {\n    // Default onClick behavior if not provided\n    if (typeof options.onClick !== 'function') {\n        options.onClick = () => console.log('desktop app - Missing options.onClick function', app.name);\n    }\n\n    // Create the shortcut element\n    const el = document.createElement('div');\n    el.className = `icon shortcut ${app.class || ''} bp-desktop-shortcut`;\n    el.setAttribute('data-app', app.name);\n    const anchor = document.createElement('a');\n    // anchor.href = app.href || `#${app.name}`;\n\n    if (!app.textIcon) {\n        const image = document.createElement('img');\n        image.className = 'bp-desktop-icon';\n        image.loading = 'lazy';\n        image.src = app.icon;\n        if (options.imageStyle) {\n            Object.keys(options.imageStyle).forEach(key => {\n                image.style[key] = options.imageStyle[key];\n            });\n        }\n        anchor.appendChild(image);\n    } else {\n        const image = document.createElement('div');\n        image.textContent = app.textIcon;\n        image.style.fontSize = '32px';\n        image.style.position = 'relative';\n        image.style.bottom = '10px';\n        if (options.imageStyle) {\n            Object.keys(options.imageStyle).forEach(key => {\n                image.style[key] = options.imageStyle[key];\n            });\n        }\n        anchor.appendChild(image);\n    }\n\n    const title = document.createElement('span');\n    title.className = 'title';\n    title.textContent = app.label || app.name;\n    anchor.appendChild(title);\n    el.appendChild(anchor);\n\n    // Adding onClick event to the .icon container\n    // TODO: make this event only happen on touchend\n    // the idea here is that if the element was dragged, we don't want to trigger the click event\n    // but if it was tapped, we do want to trigger the click event \n    /*\n    el.addEventListener('click', (e) => {\n        alert()\n        e.preventDefault();\n        options.onClick(e, app);\n        return false;\n    });\n    */\n\n    let pointerDownPos = null;\n    let wasDragging = false;\n\n    el.addEventListener('pointerdown', (e) => {\n        pointerDownPos = { x: e.clientX, y: e.clientY };\n        wasDragging = false;\n    });\n\n    el.addEventListener('pointermove', (e) => {\n        if (!pointerDownPos) return;\n\n        const dx = e.clientX - pointerDownPos.x;\n        const dy = e.clientY - pointerDownPos.y;\n        const distance = Math.sqrt(dx * dx + dy * dy);\n\n        // If moved more than a threshold, consider it a drag\n        if (distance > 5) {\n            wasDragging = true;\n        }\n    });\n\n    el.addEventListener('pointerup', (e) => {\n        if (!wasDragging) {\n            e.preventDefault(); // Prevent default anchor behavior\n            options.onClick(e, app);\n        }\n\n        pointerDownPos = null;\n        wasDragging = false;\n\n        // update the x/y position of the app shortcut inside this.bp.settings.installed_apps\n        let appsInstalled = this.bp.settings.apps_installed || {};\n        appsInstalled[app.name] = appsInstalled[app.name] || app;\n\n        appsInstalled[app.name].position = {\n            x: el.offsetLeft,\n            y: el.offsetTop\n        }\n\n        console.log('saving appsInstalled', appsInstalled)\n        this.bp.set('apps_installed', appsInstalled);\n\n        console.log('apppp', app);\n        return false;\n\n    });\n\n    // remove all existing context menus to avoid duplicates\n    /*\n    const existingMenus = document.querySelectorAll('.desktop-context-menu');\n    existingMenus.forEach(menu => {\n        menu.remove();\n    });\n    */\n\n    // Context menu setup\n    const contextMenu = document.createElement('div');\n    contextMenu.className = 'desktop-context-menu';\n    contextMenu.innerHTML = `\n        <div class=\"bp-context-menu-item\" data-action=\"delete\">Delete Shortcut</div>\n        <div class=\"bp-context-menu-item\" data-action=\"rename\">Rename Shortcut</div>\n    `;\n    document.body.appendChild(contextMenu); // Append to body for positioning\n\n    // Hide context menu on click elsewhere\n    document.addEventListener('click', () => {\n        contextMenu.style.display = 'none';\n    });\n\n    // Prevent default context menu and show custom menu\n    el.addEventListener('contextmenu', (e) => {\n\n        const existingMenu = $('.desktop-context-menu');\n        // existingMenu.hide();\n\n\n        console.log('Context menu triggered for app:', app.name);\n        e.preventDefault();\n        // Position menu near cursor, ensuring it stays within viewport\n        const menuWidth = 150; // Approximate width of context menu\n        const menuHeight = 80; // Approximate height of context menu\n        const posX = e.clientX;\n        const posY = e.clientY;\n        const maxX = window.innerWidth - menuWidth;\n        const maxY = window.innerHeight - menuHeight;\n        contextMenu.style.left = `${Math.min(posX, maxX)}px`;\n        contextMenu.style.top = `${Math.min(posY, maxY)}px`;\n        contextMenu.style.display = 'block';\n    });\n\n    // Handle context menu actions\n    contextMenu.addEventListener('click', (e) => {\n        const action = e.target.getAttribute('data-action');\n        if (action === 'delete') {\n            this.deleteShortcut(app.name, app, options.context);\n        } else if (action === 'rename') {\n            this.renameShortCut(app.name, title, options.context);\n        }\n        contextMenu.style.display = 'none';\n    });\n\n    // Append the new shortcut to the container\n    let p = parent || this.shortCutsContainer;\n    p.appendChild(el);\n\n    // Apply jQuery UI draggable if enabled\n    if (this.enableShortcutDragging) {\n        $(el).draggable({\n            containment: 'parent' // Confine dragging within the parent container\n        });\n    }\n\n    // Register the app with desktop.apps\n    app.options = options;\n    const appKey = options && options.context ? `${app.name}-${options.context}` : app.name;\n    this.apps[appKey] = app;\n\n    // Stubbed functions for context menu actions\n    this.deleteShortcut = function (appName, app, context) {\n        console.log(`Stub: Deleting shortcut for ${appName}${context ? `-${context}` : ''}`);\n        // Call removeApp to align with App Store logic\n        this.removeApp(appName, app);\n    };\n\n}","export default function arrangeShortcuts(cols = 4, options = {\n    rowWidth: 80,\n    rowHeight: 100,\n    x: 0, // TODO: we should start from the x and y position in our calculations\n    y: 0,\n    ignoreSavedPosition: true\n}) {\n    let parent;\n    if (typeof options.parent !== 'undefined') {\n        parent = options.parent;\n    } else {\n        parent = this.shortCutsContainer;\n    }\n\n    if (typeof options.rowWidth !== 'number') {\n        options.rowWidth = 74;\n        if (this.bp.isMobile()) {\n            options.rowWidth = 256;\n        }\n    }\n\n    if (typeof options.rowHeight !== 'number') {\n        options.rowHeight = 100;\n        if (this.bp.isMobile()) {\n            options.rowHeight = 256;\n        }\n    }\n\n    if (typeof options.x !== 'number') {\n        options.x = 0;\n    }\n\n    if (typeof options.y !== 'number') {\n        options.y = 0;\n    }\n\n    const containerWidth = parent.offsetWidth || 800; // Get the container's width\n    const maxCols = Math.floor(containerWidth / options.rowWidth); // Calculate the maximum number of columns\n    const actualCols = cols < maxCols ? cols : maxCols; // Choose the lesser to avoid overflow\n\n    let appsInstalled = this.bp.settings.apps_installed || {};\n\n    Array.from(parent.children).forEach((icon, index) => {\n        let appName = icon.getAttribute('data-app');\n        let app = appsInstalled[appName] || {};\n        let x = (index % actualCols) * options.rowWidth; // Calculate x position\n        let y = Math.floor(index / actualCols) * options.rowHeight; // Calculate y position\n\n        let offSetY = 100;\n        if (this.bp.isMobile()) { // TODO: remove\n            y += offSetY; // Add an offset to the y position\n\n        }\n        let offsetX = 15;\n        x += offsetX; // Add an offset to the x position\n\n        x += options.x;\n        y += options.y;\n\n        if (app && app.position && !options.ignoreSavedPosition) {\n            // If the app has a specific position, use that instead\n            x = app.position.x || x;\n            y = app.position.y || y;\n        }\n\n        // update the x/y position of the app shortcut inside this.bp.settings.installed_apps\n        appsInstalled[appName] = appsInstalled[appName] || app;\n        appsInstalled[appName].position = {\n            x: x,\n            y: y\n        }\n\n        // console.log('x:', x, 'y:', y);\n        icon.style.position = 'absolute'; // Corrected typo here\n        icon.style.left = `${x}px`; // Set left position\n        icon.style.top = `${y}px`; // Set top position\n    });\n    this.bp.set('apps_installed', appsInstalled);\n\n}","import Folder from './Folder.js';\nimport arrangeShortcuts from '../lib/shortcuts/arrangeShortCuts.js';\nexport default function addFolder(metadata) {\n\n    let that = this;\n\n    function renderItem(_item, parent) {\n\n        let item = {};\n        if (typeof _item === 'string') {\n            item.id = _item;\n            item.name = _item;\n            item.label = _item;\n        } else {\n            item = _item;\n        }\n\n        if (!item.icon) {\n            item.icon = `/desktop/assets/images/icons/icon_${item.id}_64.png`;\n        }\n\n        item.options = item.options || {};\n        that.addShortCut({\n            name: item.id,\n            icon: item.icon,\n            label: item.label,\n        }, {\n            onClick: () => {\n                bp.open(item.id, item.options);\n            },\n            ...item.options\n        }, parent);\n\n    }\n\n    let folderHolder = document.createElement('div');\n    folderHolder.className = 'folder-holder';\n\n    metadata.items.forEach(item => {\n        renderItem(item, folderHolder);\n    });\n\n\n    const folder = new Folder(metadata, {\n        desktop: this,\n        parentElement: this.shortCutsContainer,\n        depth: 0,\n        onOpen: () => {\n\n            this.arrangeShortcuts(4, {\n                parent: folderHolder,\n                x: 0,\n                y: 20\n            })\n\n            console.log('Folder opened:', metadata.name);\n            this.bp.apps.ui.windowManager.createWindow({\n                id: metadata.name,\n                title: metadata.name,\n                icon: '/desktop/assets/images/icons/icon_folder.png',\n                width: metadata.width || 400,\n                height: metadata.height || 150,\n                parent: $('#desktop').get(0),\n                content: folderHolder\n            });\n\n        }\n    });\n    this.folders.push(folder);\n\n    folder.render()\n    //this.addShortCut(folder);\n    // this.shortCutsContainer.appendChild(folder.render());\n}","export default function removeShortCut(appName) {\n    console.log(`Removing shortcut for app: ${appName}`);\n    // Find and remove a shortcut based on the app name\n    const shortcuts = Array.from(this.shortCutsContainer.children);\n    const shortcut = shortcuts.find(el => $(el).data('app') === appName);\n    if (shortcut) {\n        this.shortCutsContainer.removeChild(shortcut);\n    }\n}","export default function createShortcut() {\n    if (!this.createShortCutWindow) {\n        let shortCutHtml = `\n        <div class=\"bp-create-shortcut-container\">\n            <h2>Create Shortcut</h2>\n            <form id=\"create-shortcut-form\" action=\"#\" method=\"post\">\n                <div class=\"bp-form-group\">\n                    <label>Shortcut Type:</label>\n                    <div class=\"bp-shortcut-type\">\n                        <label><input type=\"radio\" name=\"shortcut-type\" value=\"url\" checked> URL</label>\n                        <label><input type=\"radio\" name=\"shortcut-type\" value=\"app\"> App</label>\n                        <label><input type=\"radio\" name=\"shortcut-type\" value=\"buddyscript\"> Buddyscript</label>\n                    </div>\n                </div>\n                <div class=\"bp-form-group\">\n                    <label for=\"shortcut-name\">Shortcut Name:</label>\n                    <input type=\"text\" id=\"shortcut-name\" name=\"shortcut-name\" required>\n                </div>\n                <div class=\"bp-form-group bp-app-select-group\" style=\"display: none;\">\n                    <label for=\"shortcut-apps\">Select App:</label>\n                    <select id=\"shortcut-apps\" name=\"shortcut-apps\">\n                        <option value=\"\">Select App</option>\n                        ${Object.keys(this.bp.apps.desktop.appList).map(appName => `<option value=\"${appName}\">${this.bp.apps.desktop.appList[appName].label || appName}</option>`).join('')}\n                    </select>\n                </div>\n                <div class=\"bp-form-group bp-command-group\">\n                    <label for=\"shortcut-command\">Command:</label>\n                    <input type=\"text\" id=\"shortcut-command\" name=\"shortcut-command\" required>\n                </div>\n                <div class=\"bp-form-group\">\n                    <label for=\"shortcut-icon\">Icon URL:</label>\n                    <input type=\"text\" id=\"shortcut-icon\" name=\"shortcut-icon\" placeholder=\"Optional\">\n                </div>\n                <div class=\"bp-form-group\">\n                    <label for=\"shortcut-description\">Description:</label>\n                    <textarea id=\"shortcut-description\" name=\"shortcut-description\" placeholder=\"Optional\"></textarea>\n                </div>\n                <div class=\"bp-form-group bp-form-actions\">\n                    <button type=\"submit\" class=\"bp-btn bp-btn-primary bp-create-shortcut-btn\">Create Shortcut</button>\n                    <button type=\"button\" class=\"bp-btn bp-btn-secondary\" id=\"cancel-shortcut\">Cancel</button>\n                </div>\n            </form>\n        </div>`;\n\n        this.createShortCutWindow = this.bp.apps.ui.windowManager.createWindow({\n            id: 'create-shortcut',\n            title: 'Create Shortcut',\n            icon: 'desktop/assets/images/icons/icon_console_64.png',\n            x: 250,\n            y: 75,\n            width: 600,\n            height: 400,\n            minWidth: 400,\n            minHeight: 300,\n            parent: $('#desktop')[0],\n            content: shortCutHtml,\n            resizable: true,\n            minimizable: true,\n            maximizable: true,\n            closable: true,\n            focusable: true,\n            maximized: false,\n            minimized: false,\n            onclose: () => {\n                // Clean up if needed\n            }\n        });\n\n        // Toggle app dropdown visibility based on shortcut type\n        $('#create-shortcut-form input[name=\"shortcut-type\"]').on('change', (e) => {\n            const shortcutType = e.target.value;\n            const appSelectGroup = $('.bp-app-select-group');\n            const commandGroup = $('.bp-command-group');\n            if (shortcutType === 'app') {\n                appSelectGroup.show();\n                commandGroup.hide();\n                $('#shortcut-command').prop('required', false);\n                $('#shortcut-apps').prop('required', true);\n            } else {\n                appSelectGroup.hide();\n                commandGroup.show();\n                $('#shortcut-command').prop('required', true);\n                $('#shortcut-apps').prop('required', false);\n            }\n        });\n\n        $('#create-shortcut-form').on('submit', (e) => {\n            e.preventDefault();\n            return false;\n        });\n\n        $('.bp-create-shortcut-btn').on('click', (e) => {\n            e.preventDefault();\n            const shortcutType = $('input[name=\"shortcut-type\"]:checked').val();\n            const name = $('#shortcut-name').val().trim();\n            const appName = $('#shortcut-apps').val();\n            const command = $('#shortcut-command').val().trim();\n            const icon = $('#shortcut-icon').val().trim();\n            const description = $('#shortcut-description').val().trim();\n\n            // Validation\n            if (!name) {\n                alert('Shortcut Name is required.');\n                return;\n            }\n            if (shortcutType === 'app' && !appName) {\n                alert('Please select an app.');\n                return;\n            }\n            if ((shortcutType === 'url' || shortcutType === 'buddyscript') && !command) {\n                alert('Command is required for URL or Buddyscript shortcuts.');\n                return;\n            }\n\n            // Create the shortcut object\n            const shortcut = {\n                name: name,\n                label: name,\n                shortcutType: shortcutType,\n                icon: icon || 'desktop/assets/images/icons/icon_default_64.png', // Default icon if none provided\n                description: description || '',\n                target: shortcutType === 'app' ? this.bp.apps.desktop.appList[appName]?.onClick || `bp.open('${appName}')` : command,\n                parameters: {\n                    icon: icon || '',\n                    description: description || ''\n                }\n            };\n\n            try {\n                saveShortCut.call(this, shortcut);\n            } catch (error) {\n                console.error('Error creating shortcut:', error);\n                alert('Failed to create shortcut. Please check the console for details.');\n            }\n            return false;\n        });\n\n        $('#cancel-shortcut').on('click', () => {\n            this.createShortCutWindow.close();\n        });\n    } else {\n        this.createShortCutWindow.focus();\n        this.createShortCutWindow.restore();\n    }\n}\n\nfunction saveShortCut(shortcut) {\n    console.log('Saving shortcut:', shortcut);\n    // Save to localStorage\n    const shortcuts = JSON.parse(localStorage.getItem('bp-shortcuts') || '{}');\n    shortcuts[shortcut.name] = {\n        label: shortcut.label,\n        shortcutType: shortcut.shortcutType,\n        target: shortcut.target,\n        icon: shortcut.icon,\n        description: shortcut.parameters.description\n    };\n    localStorage.setItem('bp-short великйцут', JSON.stringify(shortcuts));\n\n    // Call addShortCut to create the shortcut on the desktop\n    this.bp.apps.desktop.addShortCut({\n        name: shortcut.name,\n        label: shortcut.label,\n        icon: shortcut.icon,\n        description: shortcut.description,\n        onClick: shortcut.shortcutType === 'url' ? () => window.open(shortcut.target, '_blank') :\n                 shortcut.shortcutType === 'app' ? shortcut.target :\n                 () => eval(shortcut.target), // Note: eval for buddyscript; replace with safer execution\n        textIcon: !shortcut.icon ? shortcut.label.charAt(0).toUpperCase() : null\n    });\n\n    // Close the window\n    this.createShortCutWindow.close();\n}","export default function renameShortCut(appName, titleElement) {\n    \n    const newName = prompt('Enter new shortcut name:', titleElement.textContent);\n\n    // TODO: forbidden Note check goes here ( no bad names in shortcuts )\n    let shortcut = $(`.bp-desktop-shortcut[data-app=\"${appName}\"]`);\n    console.log(`Renaming shortcut ${shortcut} to ${newName}`);\n    console.log(`Shortcut element:`, shortcut);\n\n    /*\n    // Update the shortcut name\n    shortcut.name = newName;\n    \n    // Update the label if it exists\n    if (shortcut.label) {\n        shortcut.label = newName;\n    }\n        */\n    \n    //let titleElement = shortcut.find('.title');\n    // Update the title element's text content\n    titleElement.textContent = newName;\n\n    let installed_apps = this.bp.get('apps_installed') || {};\n    // Update the app label in the installed apps\n    if (installed_apps[appName]) {\n        installed_apps[appName].label = newName;\n        this.bp.set('apps_installed', installed_apps);\n    } else {\n        console.warn(`App ${appName} not found in installed apps.`);\n    }\n\n    // Update the icon's title text\n    /*\n    const iconElement = document.querySelector(`.bp-desktop-shortcut[data-app=\"${shortcut.name}\"] .title`);\n    if (iconElement) {\n        iconElement.textContent = newName;\n    } else {\n        console.warn(`Shortcut element for ${shortcut.name} not found.`);\n    }\n    */\n    \n    // Optionally, you can also update the app settings or any other related data\n    //this.bp.set(`apps_installed.${shortcut.name}`, shortcut);\n    \n    // Play a sound effect for renaming\n    //this.bp.play('desktop/assets/audio/APP-RENAME.wav');\n    \n    // Optionally, you can rearrange shortcuts if needed\n    // this.bp.apps.desktop.arrangeShortcuts();\n    \n    console.log(`Shortcut renamed to ${newName}`);\n};","export default {\n  \"admin\": {\n    name: 'admin',\n    icon: `desktop/assets/images/icons/icon_profile_64.png`,\n    label: 'Admin',\n    \"onClick\": \"bp.open('admin')\",\n    adminOnly: true,\n  },\n  \"profile\": {\n    \"icon\": \"desktop/assets/images/icons/icon_profile_64.png\",\n    \"label\": \"My Profile\",\n    \"description\": \"Manage your profile and settings\",\n    \"onClick\": \"bp.open('profile')\",\n    \"categories\": [\"social\", \"productivity\"]\n  },\n  \"buddylist\": {\n    \"icon\": \"desktop/assets/images/icons/icon_profile_64.png\",\n    \"label\": \"BuddyList\",\n    \"description\": \"View and manage your contacts\",\n    \"onClick\": \"bp.open('buddylist')\",\n    \"categories\": [\"social\", \"community\"]\n  },\n  \"pad\": {\n    \"icon\": \"desktop/assets/images/icons/icon_pad_64.png\",\n    \"label\": \"Buddy Apps\",\n    \"description\": \"Create hosted Apps for Buddy Pond\",\n    \"onClick\": \"bp.open('pad')\",\n    \"categories\": [\"productivity\", \"creative\", \"community\"]\n  },\n  \"pond\": {\n    \"icon\": \"desktop/assets/images/icons/icon_pond_64.png\",\n    \"label\": \"Ponds\",\n    \"description\": \"Explore shared content or communities\",\n    \"onClick\": \"bp.open('pond')\",\n    \"categories\": [\"community\", \"social\"]\n  },\n  \"file-explorer\": {\n    \"icon\": \"desktop/assets/images/icons/icon_file-explorer_64.png\",\n    \"label\": \"Buddy Files\",\n    \"description\": \"Browse and manage your files\",\n    \"onClick\": \"bp.open('file-explorer')\",\n    \"desktopOnly\": true,\n    \"categories\": [\"files\", \"productivity\"]\n  },\n  \"file-viewer\": {\n    \"icon\": \"desktop/assets/images/icons/icon_file-viewer_64.png\",\n    \"label\": \"File Viewer\",\n    \"description\": \"View files in various formats\",\n    \"onClick\": \"bp.open('file-viewer')\",\n    \"categories\": [\"files\", \"productivity\"]\n  },\n  \"paint\": {\n    \"icon\": \"desktop/assets/images/icons/icon_paint_64.png\",\n    \"label\": \"Paint\",\n    \"description\": \"Create and edit digital artwork\",\n    \"onClick\": \"bp.open('paint')\",\n    \"categories\": [\"art\", \"creative\"]\n  },\n  \"soundrecorder\": {\n    \"icon\": \"desktop/assets/images/icons/icon_soundrecorder_64.png\",\n    \"label\": \"Sound Recorder\",\n    \"description\": \"Record and save audio clips\",\n    \"onClick\": \"bp.open('soundrecorder')\",\n    \"desktopOnly\": true,\n    \"categories\": [\"audio\", \"creative\"]\n  },\n  \"youtube\": {\n    \"icon\": \"desktop/assets/images/icons/icon_interdimensionalcable_64.png\",\n    \"label\": \"Inter Dimensional Cable\",\n    \"description\": \"Watch and browse YouTube videos\",\n    \"onClick\": \"bp.open('youtube')\",\n    \"categories\": [\"entertainment\", \"media\"]\n  },\n  \"camera\": {\n    \"icon\": \"desktop/assets/images/icons/icon_camera_64.png\",\n    \"label\": \"Camera\",\n    \"description\": \"Capture photos or videos\",\n    \"onClick\": \"bp.open('camera')\",\n    \"categories\": [\"media\", \"creative\"]\n  },\n  \"piano\": {\n    \"icon\": \"desktop/assets/images/icons/icon_piano_64.png\",\n    \"label\": \"Piano\",\n    \"description\": \"Play a virtual piano keyboard\",\n    \"onClick\": \"bp.open('piano')\",\n    \"desktopOnly\": true,\n    \"categories\": [\"music\", \"creative\"]\n  },\n  \"fluid-simulation\": {\n    \"icon\": \"desktop/assets/images/icons/icon_fluidsimulation_64.png\",\n    \"label\": \"Fluid Simulation\",\n    \"description\": \"Interact with a fluid dynamics simulation\",\n    \"onClick\": \"bp.open('fluid-simulation')\",\n    \"categories\": [\"creative\", \"entertainment\"]\n  },\n  \"sampler\": {\n    \"icon\": \"desktop/assets/images/icons/icon_midifighter_64.png\",\n    \"label\": \"Sampler\",\n    \"description\": \"Create and mix audio samples\",\n    \"onClick\": \"bp.open('sampler')\",\n    \"categories\": [\"audio\", \"music\", \"creative\"]\n  },\n  \"audio-visual\": {\n    \"icon\": \"desktop/assets/images/icons/icon_visuals_64.png\",\n    \"label\": \"Audio Visuals\",\n    \"description\": \"Experience audio-responsive visuals\",\n    \"onClick\": \"bp.open('audio-visual')\",\n    \"categories\": [\"creative\", \"entertainment\", \"audio\"]\n  },\n  \"coin\": {\n    \"icon\": \"desktop/assets/images/icons/icon_coin_64.png\",\n    \"label\": \"Buddy Coins\",\n    \"description\": \"Manage your virtual currency\",\n    \"onClick\": \"bp.open('coin')\",\n    \"categories\": [\"finance\"]\n  },\n  \"portfolio\": {\n    \"icon\": \"desktop/assets/images/icons/icon_portfolio_64.png\",\n    \"label\": \"Portfolio\",\n    \"description\": \"Track your investments and assets\",\n    \"onClick\": \"bp.open('portfolio')\",\n    \"categories\": [\"finance\"]\n  },\n  \"audio-player\": {\n    \"icon\": \"desktop/assets/images/icons/icon_audio-player_64.png\",\n    \"label\": \"Audio Player\",\n    \"description\": \"Play and manage audio files\",\n    \"onClick\": \"bp.open('audio-player')\",\n    \"categories\": [\"media\", \"audio\"]\n  },\n  \"mantra\": {\n    \"icon\": \"desktop/assets/images/icons/icon_mantra_64.png\",\n    \"label\": \"Mantra\",\n    \"description\": \"Play the Mantra game\",\n    \"categories\": [\"games\"]\n  },\n  \"minesweeper\": {\n    \"icon\": \"desktop/assets/images/icons/icon_minesweeper_64.png\",\n    \"label\": \"Minesweeper\",\n    \"description\": \"Classic Minesweeper puzzle game\",\n    \"categories\": [\"games\"]\n  },\n  \"emulator-nes\": {\n    \"icon\": \"desktop/assets/images/icons/icon_nes_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'nes',\n    \"label\": \"NES\",\n    \"description\": \"Play Nintendo Entertainment System games\",\n    \"options\": { \"context\": \"nes\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-sega\": {\n    \"icon\": \"desktop/assets/images/icons/icon_sega_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'sega',\n    \"label\": \"Sega\",\n    \"description\": \"Play Sega console games\",\n    \"options\": { \"context\": \"sega\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-snes\": {\n    \"icon\": \"desktop/assets/images/icons/icon_snes_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'snes',\n    \"label\": \"SNES\",\n    \"description\": \"Play Super Nintendo games\",\n    \"options\": { \"context\": \"snes\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-atari2600\": {\n    \"icon\": \"desktop/assets/images/icons/icon_atari2600_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'atari2600',\n    \"label\": \"Atari 2600\",\n    \"description\": \"Play Atari 2600 games\",\n    \"options\": { \"context\": \"atari2600\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"emulator-n64\": {\n    \"icon\": \"desktop/assets/images/icons/icon_n64_64.png\",\n    \"app\": \"emulator\",\n    \"context\": 'n64',\n    \"label\": \"n64\",\n    \"description\": \"Play Nintendo 64 games\",\n    \"options\": { \"context\": \"n64\" },\n    \"categories\": [\"games\", \"emulators\"]\n  },\n  \"solitaire\": {\n    \"icon\": \"desktop/assets/images/icons/icon_solitaire_64.png\",\n    \"label\": \"Solitaire\",\n    \"description\": \"Classic Solitaire card game\",\n    \"categories\": [\"games\"]\n  },\n  \"globe\": {\n    \"icon\": \"desktop/assets/images/icons/icon_globe_64.png\",\n    \"label\": \"Globe\",\n    \"description\": \"Visualize global network data\",\n    \"categories\": [\"tools\"]\n  },\n  \"hacker-typer\": {\n    \"icon\": \"desktop/assets/images/icons/icon_hacker-typer_64.png\",\n    \"label\": \"Hack Typer\",\n    \"description\": \"Simulate hacking with a typing game\",\n    \"categories\": [\"tools\", \"games\"]\n  },\n  \"hex-editor\": {\n    \"icon\": \"desktop/assets/images/icons/icon_hex-editor_64.png\",\n    \"label\": \"Hex Editor\",\n    \"description\": \"Edit files in hexadecimal format\",\n    \"categories\": [\"tools\", \"productivity\"]\n  },\n  \"maps\": {\n    \"icon\": \"desktop/assets/images/icons/icon_maps_64.png\",\n    \"label\": \"Maps\",\n    \"description\": \"Access mapping and navigation tools\",\n    \"categories\": [\"tools\"]\n  },\n  \"spellbook\": {\n    \"icon\": \"desktop/assets/images/icons/icon_spellbook_64.png\",\n    \"label\": \"Spellbook\",\n    \"description\": \"Manage scripts or commands\",\n    \"categories\": [\"tools\", \"productivity\"]\n  }\n}","let sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\nexport default async function addApp(appName, app) {\n\n    if (!appName) {\n        console.error('No app name provided');\n        return;\n    }\n\n    if (!app) {\n        console.log('this.bp.apps.desktop', this.bp.apps.desktop)\n        // if no app is provided, look up the app in the appstore\n        app = this.bp.apps.desktop.appList[appName];\n    }\n\n    if (!app) {\n        console.error(`App ${appName} not found in appstore`);\n        return;\n    }\n    console.log(`Stub: Adding app ${app} to desktop`);\n    this.bp.play('desktop/assets/audio/APP-ADD.wav');\n    let installedApps = this.bp.settings.apps_installed || {};\n    // TODO: lookup actual app object from appstore.apps\n    installedApps[appName] = app;\n    this.bp.set('apps_installed', installedApps);\n    this.bp.apps.desktop.addShortCut({\n        name: appName,\n        icon: `desktop/assets/images/icons/icon_${appName}_64.png`,\n        label: app.label || appName,\n    }, {\n        onClick: () => {\n            this.bp.open(appName);\n        }\n    });\n    // this.bp.apps.desktop.hideLoadingProgressIndicator();\n    this.bp.apps.desktop.arrangeShortcuts();\n    await sleep(777); // Simulate delay for UI update\n}\n","let sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\nexport default async function removeApp(appName, app) {\n    console.log(`Stub: Adding app ${app} to desktop`);\n\n    this.bp.play('desktop/assets/audio/APP-REMOVE.wav');\n\n    let installedApps = this.bp.settings.apps_installed || {};\n    delete installedApps[appName];\n    this.bp.set('apps_installed', installedApps);\n    //desktop.ui.renderDesktopShortCuts();\n\n    // alert('removing ' + appName);\n    this.bp.apps.desktop.removeShortCut(appName);\n\n    // desktop.ui.hideLoadingProgressIndicator();\n    this.bp.apps.desktop.arrangeShortcuts();\n    await sleep(777); // Simulate delay for UI update\n\n}\n","// TODO: implement context menu options for desktop itself\nexport default function setupContextMenu() {\n    this.container.oncontextmenu = (event) => {\n        // check if target has class \"bp-desktop-icon\"\n        if (event.target.classList.contains('bp-desktop-icon')) {\n            // If it does, prevent the default context menu\n            return;\n        }\n\n        // find any existing context menu and remove it\n        const existingMenu = $('.desktop-context-menu');\n        existingMenu.hide();\n\n        event.preventDefault();\n        this.showContextMenu(event.clientX, event.clientY);\n    };\n}","export default function  showContextMenu(x, y) {\n\n    const menu = document.createElement('div');\n    menu.className = 'desktop-context-menu';\n    menu.style.top = `${y}px`;\n    menu.style.left = `${x}px`;\n    menu.style.display = 'block';\n    // z-index is needed to display the menu on top of other elements\n    menu.style.zIndex = '9999';\n    menu.innerHTML = `\n        <ul>\n            <!-- <li onclick=\"bp.apps.desktop.createShortCut()\">New Shortcut...</li> -->\n            <li onclick=\"bp.apps.desktop.arrangeShortcuts(3, {\n    rowWidth: 80,\n    rowHeight: 100,\n    x: 0,\n    y: 0,\n    ignoreSavedPosition: true\n            })\">Arrange Icons</li>\n            <li onclick=\"bp.open('profile', { context: 'themes' })\">Desktop Settings</li>\n            <li onclick=\"bp.apps.wallpaper.removeWallpaper()\">Remove Wallpaper</li>\n            <li onclick=\"bp.apps.desktop.viewSource()\">View Source</li>\n        </ul>\n    `;\n    // clear the body before appending the menu\n    document.body.appendChild(menu);\n    // Hide menu on click anywhere\n    document.addEventListener('click', () => menu.remove(), { once: true });\n}","export default async function viewSource (url = 'https://raw.githubusercontent.com/Marak/buddypond/refs/heads/master/index.html') {\n    // fetch the content as text\n    const response = await fetch(url);\n    const content = await response.text();\n    await this.bp.load('editor-monaco', {\n        content: content\n    });\n    this.bp.apps['editor-monaco'].open();\n}","export default function defaultDesktopShortcuts() {\n\n    // check if we have default apps, if not initialize them\n    let installeApps = this.bp.settings.apps_installed || {};\n    if (Object.keys(installeApps).length === 0) {\n        let defaultAppList = [\n            'profile',\n            'buddylist',\n            'pad',\n            'pond',\n            'file-explorer',\n            'youtube',\n            'fluid-simulation',\n            'coin',\n            'portfolio',\n        ];\n\n        defaultAppList.forEach(appName => {\n            let app = this.bp.apps.desktop.appList[appName];\n            if (app) {\n                console.log(`Adding default app shortcut: ${appName}`);\n                console.log(app);\n                installeApps[appName] = app;\n\n                // this.bp.apps.desktop.addShortCut(app);\n            } else {\n                console.warn(`App ${appName} not found in desktop app list.`);\n            }\n        });\n\n        this.bp.set('apps_installed', installeApps);\n\n    }\n\n    let installedApps = bp.settings.apps_installed || {};\n    if (Object.keys(installedApps).length > 0) {\n        Object.keys(installedApps).forEach(appName => {\n            let app = installedApps[appName];\n            if (app) {\n                bp.apps.desktop.addShortCut({\n                    name: appName,\n                    icon: app.icon || `desktop/assets/images/icons/icon_app_64.png`,\n                    label: app.label || appName,\n                    description: app.description || 'No description available'\n                }, {\n                    onClick: () => {\n                        bp.open(appName);\n                    }\n                });\n            }\n        });\n\n    }\n\n}","/* Desktop.js - Buddy Pond - Marak Squires - 2023 */\n\n// import Folder from '../file-explorer/Folder/Folder.js';\nimport Folder from \"./lib/Folder.js\";\nimport File from \"./lib/File.js\";\n\n// shortcuts\nimport addShortCut from \"./lib/shortcuts/addShortCut.js\";\nimport addFolder from \"./lib/addFolder.js\";\nimport removeShortCut from \"./lib/shortcuts/removeShortCut.js\";\nimport createShortCut from \"./lib/shortcuts/createShortCut.js\";\nimport renameShortCut from \"./lib/shortcuts/renameShortCut.js\";\nimport arrangeShortcuts from \"./lib/shortcuts/arrangeShortCuts.js\";\n\n// apps\nimport appList from \"./lib/appList.js\";\nimport addApp from \"./lib/apps/addApp.js\";\nimport removeApp from \"./lib/apps/removeApp.js\";\n\n\n// context menu(s)\nimport setupContextMenu from \"./lib/contextmenu/setupContextMenu.js\";\nimport showContextMenu from \"./lib/contextmenu/showContextMenu.js\";\n\n// utils\nimport buildJsTreeData from \"../file-explorer/lib/buildJsTreeData.js\";\nimport viewSource from \"./lib/viewSource.js\";\n\n\n// default data\nimport defaultDesktopShortcuts from \"./lib/defaultDesktopShortcuts.js\";\n\nexport default class Desktop {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        this.options = options;\n\n        this.apps = {}; // registered apps\n\n        this.folders = [];\n\n        // Setup containers for the desktop and shortcuts\n        this.container = document.createElement('div');\n        this.container.id = 'desktop-container';\n        this.container.className = 'desktop-container';\n\n        this.shortCutsContainer = document.createElement('div');\n        this.shortCutsContainer.id = 'desktop-shortcuts-container';\n        this.shortCutsContainer.className = 'desktop-shortcuts-container';\n        this.container.appendChild(this.shortCutsContainer);\n\n        // Set parent container\n        this.parent = options.parent || document.body;\n        this.parent.appendChild(this.container);\n\n        this.enableShortcutDragging = true;\n\n        if (typeof options.enableShortcutDragging === 'boolean') {\n            this.enableShortcutDragging = options.enableShortcutDragging;\n        }\n\n        // Context menu for desktop\n        this.setupContextMenu();\n    }\n\n    async init() {\n        await this.bp.load('/v5/apps/based/desktop/desktop.css');\n\n        // Used for parsing shortcuts, not needed ( for now )\n        //let yaml = await this.bp.importModule('/v5/apps/based/ui/vendor/js-yaml.min.js', {}, false);\n        //this.yaml = yaml.jsYamlDefault;\n\n        // Render the default shortcuts\n        defaultDesktopShortcuts.call(this);\n\n        /*\n        if (this.bp.settings.wallpaper_url) {\n            // won't work unless desktop is already loaded\n            this.bp.apps.desktop.setWallpaper(this.bp.settings.wallpaper_url);\n        } else {\n            this.bp.apps.wallpaper.wallpaperManager.active = this.bp.settings.wallpaper_name || 'solid';\n            this.bp.apps.wallpaper.wallpaperManager.start();\n        }\n        */\n\n        // check if there is a wallpaper_url\n        /*\n        if (this.bp.settings.wallpaper_url) {\n            this.setWallpaper(this.bp.settings.wallpaper_url);\n        }\n        */\n\n        // console.log('this.bp.settings.active_theme', this.bp.settings.active_theme)\n        /*\n        if (this.bp.settings.active_theme) {\n            // alert(this.bp.settings.active_theme);\n            this.bp.apps.themes.applyTheme(this.bp.settings.active_theme);\n        }\n        */\n\n\n\n        // if (this.bp.settings.wallpaper) {\n\n        // TODO: after launch, port legacy wallpaper app\n        // this.setupWallpaper(); // Set initial wallpaper\n        return 'loaded desktop';\n    }\n\n    async load() {\n        return;\n        // get file list from cdn\n        // returns cloudFiles.files ( a flat array of relative file and directory paths )\n        let cloudFiles = await this.bp.apps.client.api.listFiles('desktop', 6);\n\n        // converts the flat array of files and directories into a nested jsTree data structure\n        // this conforms to the jsTree data format\n        /*\n\n        // Expected format of the node (there are no required fields)\n            {\n            id          : \"string\" // will be autogenerated if omitted\n            text        : \"string\" // node text\n            icon        : \"string\" // string for custom\n            state       : {\n                opened    : boolean  // is the node open\n                disabled  : boolean  // is the node disabled\n                selected  : boolean  // is the node selected\n            },\n            children    : []  // array of strings or objects\n            li_attr     : {}  // attributes for the generated LI node\n            a_attr      : {}  // attributes for the generated A node\n            }\n        */\n\n        // TODO: which will be easier to write a renderer for? flat array or tree data?\n        // We believe tree data will be easier to write a renderer for\n        let treeData = buildJsTreeData(this.bp.me, cloudFiles.files);\n        console.log('treeData', treeData);\n\n        // example shortcut format\n        let yamlStr = `\n                type: Shortcut\n                target: /path/to/application.exe\n                parameters:\n                startIn: /path/to/\n                args: \"--example-arg\"\n                icon: /path/to/icon.png\n                hotkey: Ctrl+Alt+A\n                description: \"A shortcut to an application\"\n        `;\n        // load the yaml as json\n        let doc = this.yaml.load(yamlStr);\n        console.log(doc);\n\n        // we now have treeData which is the form of a jsTree data structure\n        let userRoot = treeData[0]; // the top node is the buddyname / user root / foldername on CDN\n        console.log('userRoot', userRoot) // the desktop folder itself ( since we query for it )\n        let desktopRoot = userRoot.children[0]; // the desktop folder itself ( since we query for it )\n\n        // the problem is now we intended to render the \"Desktop\" folder contents at the top-level\n        // ( such that all its children are visible on the desktop )\n        // however; with the current structure we see a \"desktop\" folder on the desktop\n        // TODO: we need a way to render the co ntents of a folder at a top-level\n        // or change the way folders are rendered\n        // render the userRoot\n        this.renderNode(desktopRoot, this.shortCutsContainer, 0, true);\n       // arrangeDesktop(); // global ( for now remove later )\n\n        return;\n\n\n\n    }\n\n    renderNode(node, parentElement, depth = 0, skipFolderUI = false) {\n        console.log('renderNode', node, parentElement, depth, skipFolderUI);\n        if (node.children && node.children.length > 0) {\n            // Check if we should skip rendering the folder UI (used for top-level folder)\n            if (skipFolderUI) {\n                // Directly render the children in the parent element\n                node.children.forEach(child => this.renderNode(child, parentElement, depth + 1));\n            } else {\n                // It's a folder and should be rendered as such\n                const folder = new Folder(node, parentElement, this, depth);\n                folder.render();\n            }\n        } else {\n            // It's a file or shortcut\n            if (node.text.endsWith('.yml')) {\n                const shortcut = new Shortcut(node, parentElement);\n                shortcut.render();\n            } else {\n                const file = new File(node, parentElement, this, depth);\n                file.render();\n            }\n        }\n    }\n\n    toggleMute () {\n        if (this.bp.settings.audio_enabled === false) {\n          this.bp.set('audio_enabled', true);\n          $('.volumeFull').show();\n          $('.volumeMuted').hide();\n          this.bp.play('desktop/assets/audio/VOLUME-ON.mp3', { tryHard: Infinity });\n        } else {\n          this.bp.set('audio_enabled', false);\n          $('.volumeFull').hide();\n          $('.volumeMuted').show();\n        }\n    }\n\n    openFolder(folderId) {\n        console.log('openFolder', folderId);\n        // Find the folder by ID\n        const folder = this.folders.find(f => f.data.name === folderId);\n        if (folder) {\n            // Open the folder (this could be a method in the Folder class)\n            folder.open();\n        } else {\n            console.error(`Folder with ID ${folderId} not found.`);\n        }\n    }\n\n}\n\nDesktop.prototype.Folder = Folder;\nDesktop.prototype.File = File;\nDesktop.prototype.addShortCut = addShortCut;\nDesktop.prototype.addFolder = addFolder;\nDesktop.prototype.removeShortCut = removeShortCut;\nDesktop.prototype.arrangeShortcuts = arrangeShortcuts;\nDesktop.prototype.setupContextMenu = setupContextMenu;\nDesktop.prototype.showContextMenu = showContextMenu;\n// Desktop.prototype.buildJsTreeData = buildJsTreeData;\nDesktop.prototype.viewSource = viewSource;\n\nDesktop.prototype.showDesktopIcons = function showDesktopIcons() {\n    this.shortCutsContainer.style.display = 'flex';\n    if (this.bp.isMobile()) {\n        this.shortCutsContainer.style.position = 'absolute';\n        this.shortCutsContainer.style.left = '0px';\n        this.shortCutsContainer.style.bottom = '0px';\n    }\n}\n\nclass Shortcut {\n    constructor(data, parentElement) {\n        this.data = data;\n        this.parentElement = parentElement;\n    }\n\n    render() {\n        const shortcutElement = document.createElement('div');\n        shortcutElement.textContent = this.data.text || this.data.id;\n        shortcutElement.className = 'shortcut';\n\n        shortcutElement.classList.add('icon', 'shortcut', 'bp-desktop-iconp');   \n\n        this.parentElement.appendChild(shortcutElement);\n    }\n}\n\nDesktop.prototype.appList = appList;\nDesktop.prototype.createShortCut = createShortCut;\nDesktop.prototype.renameShortCut = renameShortCut;\nDesktop.prototype.addApp = addApp;\nDesktop.prototype.removeApp = removeApp;\n"],"names":["Folder","constructor","data","options","this","parentElement","desktop","depth","render","app","folderDiv","document","createElement","className","class","classList","add","anchor","image","loading","src","title","textContent","label","name","id","appendChild","$","draggable","containment","addEventListener","e","onOpen","open","File","console","log","el","icon","onClick","enableShortcutDragging","addShortCut","parent","setAttribute","textIcon","style","fontSize","position","bottom","imageStyle","Object","keys","forEach","key","pointerDownPos","wasDragging","x","clientX","y","clientY","dx","dy","Math","sqrt","preventDefault","appsInstalled","bp","settings","apps_installed","offsetLeft","offsetTop","set","contextMenu","innerHTML","body","display","posX","posY","maxX","window","innerWidth","maxY","innerHeight","left","min","top","action","target","getAttribute","deleteShortcut","context","renameShortCut","shortCutsContainer","appKey","apps","appName","removeApp","arrangeShortcuts","cols","rowWidth","rowHeight","ignoreSavedPosition","isMobile","containerWidth","offsetWidth","maxCols","floor","actualCols","Array","from","children","index","addFolder","metadata","that","folderHolder","items","item","_item","renderItem","folder","ui","windowManager","createWindow","width","height","get","content","folders","push","removeShortCut","shortcut","find","removeChild","createShortcut","createShortCutWindow","focus","restore","shortCutHtml","appList","map","join","minWidth","minHeight","resizable","minimizable","maximizable","closable","focusable","maximized","minimized","onclose","on","shortcutType","value","appSelectGroup","commandGroup","show","hide","prop","val","trim","command","description","alert","parameters","saveShortCut","call","error","close","shortcuts","JSON","parse","localStorage","getItem","setItem","stringify","eval","charAt","toUpperCase","titleElement","newName","prompt","installed_apps","warn","admin","adminOnly","profile","categories","buddylist","pad","pond","desktopOnly","paint","soundrecorder","youtube","camera","piano","sampler","coin","portfolio","mantra","minesweeper","solitaire","globe","maps","spellbook","sleep","ms","Promise","resolve","setTimeout","async","addApp","play","installedApps","setupContextMenu","container","oncontextmenu","event","contains","showContextMenu","menu","zIndex","remove","once","viewSource","url","response","fetch","text","load","defaultDesktopShortcuts","installeApps","length","Desktop","init","renderNode","node","skipFolderUI","child","endsWith","Shortcut","toggleMute","audio_enabled","tryHard","Infinity","openFolder","folderId","f","prototype","showDesktopIcons","shortcutElement","createShortCut"],"mappings":"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"}