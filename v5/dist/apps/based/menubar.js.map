{"version":3,"file":"menubar.js","sources":["../../../apps/based/menubar/lib/defaultMenuBar.js","../../../apps/based/menubar/menubar.js"],"sourcesContent":["export default function defaultMenuBar(bp) {\n\n  // Ported from Legacy bp v4\n  let selectMusicPlaylist2 = `\n    <select name=\"selectPlaylist\" class=\"selectPlaylist float_right\">\n    <option>Select music playlist...</option>\n    <option value=\"1397230333\">Buddy House 0 ( 33 Tracks )</option>\n    <option value=\"1397493787\">Buddy House 1 ( 10 Tracks )</option>\n    <option value=\"1427128612\">Buddy House 2 ( 10 Tracks )</option>\n    </select>\n    `;\n\n\n      let selectMusicPlaylist = `\n<div class=\"dropdown-wrapper float_right select-playlist-dropdown-menu\">\n  <span class=\"icon trigger\" title=\"Select Music Playlist\">\n    <i class=\"fa-duotone fa-regular fa-music\"></i> Select Music Playlist\n  </span>\n  <ul class=\"dropdown-menu\" style=\"display: none;\">\n    <li data-value=\"1397230333\">Buddy House 0 (33 Tracks)</li>\n    <li data-value=\"1397493787\">Buddy House 1 (10 Tracks)</li>\n    <li data-value=\"1427128612\">Buddy House 2 (10 Tracks)</li>\n  </ul>\n</div>\n    `;\n\n  // change to select background / wallpaper / customize theme\n  let selectTheme = `\n    <select name=\"selectTheme\" class=\"selectTheme float_right\">\n    <option value=\"Light\">Light Theme</option>\n    <option value=\"Dark\">Dark Theme</option>\n    <option value=\"Nyan\">Nyan Theme</option>\n    <option value=\"Hacker\">Hacker Theme</option>\n    <option value=\"Water\">Water Theme</option>\n    <option value=\"Customize\">Customize...</option>\n    <!--\n    <option value=\"Customize\">EPIC MODE ( my poor browser ) </option>\n    <option value=\"Customize\">Comic Theme</option> \n    -->\n    </select>\n    `;\n\n\n\n  //        <span class=\"personalizeDesktop float_right\"><i class=\"fa-duotone fa-regular fa-desktop\" title=\"Desktop Settings\"></i>Desktop Settings</span>\n\n  let selectDesktopSettings = `\n<div class=\"dropdown-wrapper desktop-settings-dropdown-menu\">\n  <span class=\"icon trigger\" title=\"Desktop Settings\">\n    <i class=\"fa-duotone fa-regular fa-desktop\"></i> Desktop Settings\n  </span>\n  <ul class=\"dropdown-menu\" style=\"display: none;\">\n    <li data-value=\"open\">Open Desktop Settings</li>\n    <li data-value=\"matrix\">Matrix Wallpaper</li>\n    <li data-value=\"nyancat\">Nyan Cat Wallpaper</li>\n    <li data-value=\"ripples\">Ripples Wallpaper</li>\n    <li data-value=\"urlWallpaper\">Set Wallpaper to Url</li>\n  </ul>\n</div>\n    `;\n\n\n  let sourceCodeStr = `<span title=\"View Source Code\">\n    <i class=\"fa-duotone fa-regular fa-code\"></i> Source Code\n  </span>`;\n  // use fonr-awesome sun and moon icons\n  let selectLightMode = '<span class=\"selectLightMode float_right\"><i class=\"fa-duotone fa-regular fa-sun\" data-mode=\"Light\" title=\"Light Mode\"></i><i class=\"fa-duotone fa-regular fa-moon\" data-mode=\"Dark\" title=\"Dark Mode\"></i></span>';\n\n  let networkStatsStr = `\n      <span class=\"totalConnected loggedIn\">\n        <!-- <span class=\"totalConnectedCount\">0</span> Buddies Online</span> -->\n        <span class=\"desktopDisconnected loggedOut\">Disconnected</span>\n            \n    `;\n\n  let volumeStr = `\n    <div class=\"volume\">\n    <span class=\"volumeIcon volumeToggle volumeFull\">ðŸ”Š</span>\n    <span class=\"volumeIcon volumeToggle volumeMuted\">ðŸ”‡</span>\n    \n    <!-- <input type=\"range\" min=\"0\" max=\"100\" value=\"100\" class=\"volumeSlider\"> -->\n    </div>\n    `;\n\n  let clockStr = `\n    <span class=\"\" id=\"clock\"></span>\n    `;\n\n  let menuTemplate = [\n    {\n      label: '<span id=\"me_title\" class=\"me_title\">Welcome - You look nice today!</span>',\n      submenu: [\n        {\n          label: 'We are stoked to be your Buddy'\n          // click: () => api.ui.toggleDeviceSettings() \n        },\n              {\n          label: 'Buddy Apps',\n          click: () => bp.open('pad')\n        },\n\n        {\n          label: 'Edit Profile',\n          click: () => bp.open('profile')\n        },\n        {\n          label: '<span class=\"loggedOut\">Login</span>',\n          //visible: !bp.apps.client.isLoggedIn(), // Only show if logged out\n          click: () => bp.open('buddylist')\n        },\n        {\n          label: '<span class=\"loggedIn\">Logout</span>',\n          //visible: bp.apps.client.isLoggedIn(), // Only show if logged in\n          click: () => {\n            if (bp.logout) {\n\n              bp.logout();\n            }\n            //bp.apps.client.logout();\n            // Close all chat windows and ponds\n            bp.apps.ui.windowManager.windows.forEach((window) => {\n              if (window.app === 'buddylist' && (window.type === 'buddy' || window.type === 'pond')) {\n                window.close();\n              }\n              if (window.app === 'pond') {\n                window.close();\n              }\n            });\n          }\n        }\n      ]\n    },\n    {\n      label: 'Window',\n      submenu: [\n        { label: 'Full Screen', click: () => bp.apps.ui.toggleFullScreen() },\n        {\n          label: 'Hide All Windows',\n          click: () => bp.apps.ui.windowManager.minimizeAllWindows()\n        },\n        /*\n        {\n            label: 'Set Active Window to Wallpaper',\n            disabled: true,\n            click: () => {\n                if (!desktop.ui.wallpaperWindow) {\n                    desktop.ui.wallpaperWindow = true;\n                    desktop.ui.removeWindowWallpaper();\n                    desktop.ui.setActiveWindowAsWallpaper();\n                    $('.setWindowAsWallpaper').html('Remove Window as Wallpaper');\n                } else {\n                    desktop.ui.wallpaperWindow = false;\n                    desktop.ui.removeWindowWallpaper();\n                    $('.setWindowAsWallpaper').html('Set Active Window to Wallpaper');\n                }\n                return false;\n            }\n        } */\n\n      ]\n    },\n    {\n      label: '<span style=\"display:flex;\">$GBP Coin Balance: <span id=\"menu-bar-coin-balance\" class=\"odometer\">0</span></span>',\n      submenu: [\n        {\n          label: 'View Coin Balance',\n          click: () => bp.open('portfolio')\n        },\n        /*\n        {\n          label: 'Buy Coins',\n          click: () => bp.open('buycoins')\n        },\n        */\n        {\n          label: 'Send Coins',\n          click: () => bp.open('portfolio', { context: '#portfolio-transfer' })\n        }\n      ]\n    },\n    {\n      label: `\n              <span class=\"loggedIn\">Next Reward in: <span id=\"menu-bar-coin-reward-coindown\" class=\"countdown-date\">0:59</span></span>\n              <!-- <span class=\"loggedOut\">Login to get Coin Rewards</span> -->\n            `,\n    },\n    /*\n    {\n      label: 'Help',\n      click: () => bp.open('help')\n    },\n    */\n\n    { label: '', flex: 1 }, // empty space\n\n\n    { label: selectMusicPlaylist },\n\n    // { label: selectTheme },\n    // { label: desktopSettings },\n    {\n      label: selectDesktopSettings,\n      /*\n      click: () => {\n        // open the personalize desktop window\n        bp.open('profile', { context: 'themes' });\n      }\n      */\n    },\n\n    // { label: networkStatsStr },\n    {\n      label: sourceCodeStr,\n      click: () => {\n        // open a new window to https://github.com/marak/buddypond\n        let url = 'https://github.com/marak/buddypond';\n        window.open(url, '_blank');\n      }\n    },\n    { label: selectLightMode },\n\n    {\n      label: volumeStr,\n      click: () => {\n        console.log('Volume toggle clicked');\n        bp.apps.desktop.toggleMute();\n      }\n\n    },\n    { label: clockStr }\n  ];\n\n\n  return menuTemplate;\n\n}","/* MenuBar.js - Marak Squires - BuddyPond - 2023 */\nimport defaultMenuBar from \"./lib/defaultMenuBar.js\";\n\nexport default class MenuBar {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        this.options = options;\n        this.menus = {}; // Store named menus\n        this.currentMenuData = []; // Active menu structure\n        this.menuBarElement = null; // Reference to menu DOM element\n    }\n\n    async init() {\n        await this.bp.appendCSS('/v5/apps/based/menubar/menubar.css');\n        this.bp.on('auth::logout', 'reset-menu', () => $('.me_title').html('Sign In'));\n        this.load();\n    }\n\n    load(menuData = {}, parent = document.body) {\n        this.currentMenuData = defaultMenuBar(this.bp);\n        this.renderMenu(parent);\n    }\n\n    setDefaultMenu() {\n        this.currentMenuData = defaultMenuBar(this.bp);\n        this.renderMenu();\n    }\n\n    setMenu(menuName, menuItems) {\n        if (menuName) {\n            if (menuItems) {\n                this.menus[menuName] = menuItems; // Add/update a named menu\n            } else {\n                delete this.menus[menuName]; // Remove a named menu\n            }\n        } else {\n            this.currentMenuData = menuItems || []; // Replace the entire menu\n        }\n\n        // Ensure that the most relevant menu data is used\n        const menuData = this.currentMenuData.length\n            ? this.currentMenuData\n            : Object.values(this.menus).flat();\n\n        console.log('new menuData', menuData);\n        this.renderMenu(undefined, menuItems);\n    }\n\n    renderMenu(parent = document.body, menuData = this.currentMenuData) {\n        if (this.menuBarElement) {\n            this.menuBarElement.remove();\n        }\n\n        //console.log('Rendering menu with data:', menuData);\n\n        this.menuBarElement = new MenuBarClass(menuData).createMenu();\n        // console.log('new menuBarElement', parent, this.menuBarElement);\n        parent.appendChild(this.menuBarElement);\n\n        // update the default values based on local storage settings\n        // TODO: we may want to move this somewhere else\n        console.log('setting current theme', this.bp.settings.active_theme);\n        if (this.bp.settings.active_theme) {\n            $('.selectTheme', this.menuBarElement).val(this.bp.settings.active_theme);\n        } else {\n            $('.selectTheme', this.menuBarElement).val('Dark');\n        }\n        console.log('setting audio', this.bp.settings.audio_enabled);\n        if (this.bp.settings.audio_enabled === false) {\n            $('.volumeFull').hide();\n            $('.volumeMuted').show();\n        } else {\n            $('.volumeFull').show();\n            $('.volumeMuted').hide();\n        }\n        // alert(this.bp.settings.audio_enabled);\n\n        $('.selectLightMode i', this.menuBarElement).on('click', function (e) {\n            let mode = $(e.target).data('mode');\n            //alert('set the mode to ' + mode);\n            bp.apps.themes.applyTheme(mode);\n        });\n\n        $('.icon.trigger').on('click', function (e) {\n            e.stopPropagation(); // Prevent click from bubbling to document\n            $(this).siblings('.dropdown-menu').slideToggle(200);\n        });\n\n        // Handle option selection\n        $('.desktop-settings-dropdown-menu li').on('click', function () {\n            const value = $(this).data('value');\n            const text = $(this).text();\n            // Update the trigger text/icon if desired\n            /*\n            $(this).closest('.dropdown-wrapper').find('.icon.trigger').html(\n                `<i class=\"fa-duotone fa-regular fa-desktop\"></i> ${text}`\n            );\n            */\n            // Hide the dropdown\n            $(this).parent().slideUp(200);\n            // Handle the selected value (e.g., perform an action)\n            console.log('Selected:', value);\n\n            if (!value) {\n                return;\n            }\n            if (value === 'urlWallpaper') {\n                bp.apps.wallpaper.setWallpaper();\n                return;\n            }\n            if (value === 'open') {\n                // open the desktop settings\n                bp.open('profile', { context: 'themes' });\n                return;\n            }\n            // clear wallpaper_url if exists\n            bp.set('wallpaper_url', null);\n            bp.set('wallpaper_name', value);\n        });\n\n        $('.select-playlist-dropdown-menu li').on('click', function () {\n            const value = $(this).data('value');\n            const text = $(this).text();\n            // Update the trigger text/icon if desired\n            /*\n            $(this).closest('.dropdown-wrapper').find('.icon.trigger').html(\n                `<i class=\"fa-duotone fa-regular fa-desktop\"></i> ${text}`\n            );\n            */\n            // Hide the dropdown\n            $(this).parent().slideUp(200);\n            // Handle the selected value (e.g., perform an action)\n            console.log('Selected:', value);\n\n            $('#soundcloudiframe').remove();\n            $('#soundcloudplayer').html('');\n            /*\n            if (desktop.app.soundcloud) {\n                desktop.app.soundcloud.embeded = false;\n            }\n            desktop.ui.openWindow('soundcloud', { playlistID: $(this).val() });\n            */\n            if (bp.apps.soundcloud) {\n                bp.apps.soundcloud.soundCloudEmbeded = false; // reload\n            }\n            bp.open('soundcloud', { playlistID: value });\n\n\n            return;\n\n            if (!value) {\n                return;\n            }\n            if (value === 'urlWallpaper') {\n                bp.apps.desktop.setWallpaper();\n            }\n            if (value === 'open') {\n                // open the desktop settings\n                bp.open('profile', { context: 'themes' });\n                return;\n            }\n            bp.set('wallpaper_name', value);\n        });\n\n\n        // Close dropdown when clicking outside\n        $(document).on('click', function (e) {\n            if (!$(e.target).closest('.dropdown-wrapper').length) {\n                $('.dropdown-menu').slideUp(200);\n            }\n        });\n\n        // TODO: could move this elsewhere\n        let countDownEl = $('#menu-bar-coin-reward-coindown');\n        // console.log('Setting countdown for menu bar coin reward', expiry, countDownEl.length);\n        // set data-ctime to the current time\n        function startCountdown() {\n            const rewardPeriod = 60 * 1000; // 60 seconds\n            const expiry = new Date(Date.now() + rewardPeriod);\n            // console.log(\"Starting countdown for menu bar coin reward\", expiry, countDownEl.length);\n\n            function restartCountdown($el) {\n                bp.apps.rewards.requestReward();\n\n                setTimeout(() => {\n                    const newExpiry = new Date(Date.now() + rewardPeriod);\n                    bp.apps.ui.countdownManager.startCountdown($el, newExpiry, restartCountdown);\n                }, 10);\n            }\n\n            bp.apps.ui.countdownManager.startCountdown(countDownEl, expiry, restartCountdown);\n        }\n\n        if (this.bp.qtokenid) {\n            // will most likely not hit this case, since the menu bar is loaded before login completes\n            startCountdown();\n        } else {\n            // in most cases we will hit this case, where login token is received after menu bar is loaded\n            $('.loggedIn').flexHide();\n            // create event listen for 'auth::login' to start the countdown\n            this.bp.on('auth::qtoken', 'start-rewards-timer', () => {\n                // console.log('Starting rewards timer after login');\n                startCountdown();\n            });\n        }\n\n    }\n}\n\nclass MenuBarClass {\n    constructor(menuTemplate, options = {}) {\n        this.menuTemplate = menuTemplate;\n        this.menuBarElement = null;\n        this.id = options.id || \"menu-bar\";\n    }\n\n    createMenu() {\n        this.menuBarElement = document.createElement(\"div\");\n        this.menuBarElement.classList.add(\"menu-bar\");\n        this.menuBarElement.classList.add(\"desktop-menu-bar\");\n        this.menuBarElement.id = this.id;\n\n        this.menuTemplate.forEach(menuItem => this.createMenuItem(menuItem));\n        this.addGlobalEventListeners();\n\n        return this.menuBarElement;\n    }\n\n    createMenuItem(menuItem) {\n        const menuButton = document.createElement(\"div\");\n        menuButton.classList.add(\"menu-item\");\n        menuButton.innerHTML = menuItem.label;\n\n        if (menuItem.flex) {\n            menuButton.style.flex = menuItem.flex;\n        }\n\n        /*\n        if (menuItem.label instanceof HTMLElement) {\n            menuButton.appendChild(menuItem.label);\n        } else if (typeof menuItem.label === 'object') {\n            menuButton.textContent = menuItem.label.label;\n        } else {\n            menuButton.innerHTML = menuItem.label;\n        }\n        */\n\n\n        if (menuItem.className) {\n            menuButton.classList.add(menuItem.className);\n        }\n\n        menuButton.onclick = (event) => {\n            event.stopPropagation();\n            if (menuItem.click) {\n                menuItem.click();\n            }\n        };\n\n        if (menuItem.submenu) {\n            const submenuContainer = this.createSubMenu(menuItem.submenu);\n            menuButton.appendChild(submenuContainer);\n            menuButton.addEventListener(\"mouseover\", () => submenuContainer.style.display = \"block\");\n            menuButton.addEventListener(\"mouseleave\", () => submenuContainer.style.display = \"none\");\n        }\n\n        this.menuBarElement.appendChild(menuButton);\n    }\n\n    createSubMenu(submenuItems) {\n        const submenuContainer = document.createElement(\"div\");\n        submenuContainer.classList.add(\"submenu\");\n\n        submenuItems.forEach(subItem => {\n            const subMenuItem = document.createElement(\"div\");\n            subMenuItem.classList.add(\"submenu-item\");\n            subMenuItem.innerHTML = subItem.label;\n\n            if (subItem.click) {\n                subMenuItem.onclick = (event) => {\n                    event.stopPropagation();\n                    subItem.click();\n                };\n            }\n\n            if (subItem.submenu) {\n                const nestedSubMenu = this.createSubMenu(subItem.submenu);\n                subMenuItem.appendChild(nestedSubMenu);\n                subMenuItem.addEventListener(\"mouseover\", () => nestedSubMenu.style.display = \"block\");\n                subMenuItem.addEventListener(\"mouseleave\", () => nestedSubMenu.style.display = \"none\");\n            }\n\n            submenuContainer.appendChild(subMenuItem);\n        });\n\n        return submenuContainer;\n    }\n\n    addGlobalEventListeners() {\n        document.addEventListener(\"click\", (event) => {\n            if (!this.menuBarElement.contains(event.target)) {\n                this.closeAllSubmenus();\n            }\n        });\n\n        document.addEventListener(\"keydown\", (event) => {\n            if (event.key === \"Escape\") {\n                this.closeAllSubmenus();\n            }\n        });\n    }\n\n    closeAllSubmenus() {\n        document.querySelectorAll(\".submenu\").forEach(submenu => submenu.style.display = \"none\");\n    }\n}\n"],"names":["defaultMenuBar","bp","label","submenu","click","open","logout","apps","ui","windowManager","windows","forEach","window","app","type","close","toggleFullScreen","minimizeAllWindows","context","flex","console","log","desktop","toggleMute","MenuBar","constructor","options","this","menus","currentMenuData","menuBarElement","init","appendCSS","on","$","html","load","menuData","parent","document","body","renderMenu","setDefaultMenu","setMenu","menuName","menuItems","length","Object","values","flat","undefined","remove","MenuBarClass","createMenu","appendChild","settings","active_theme","val","audio_enabled","hide","show","e","mode","target","data","themes","applyTheme","stopPropagation","siblings","slideToggle","value","text","slideUp","set","wallpaper","setWallpaper","soundcloud","soundCloudEmbeded","playlistID","closest","countDownEl","startCountdown","expiry","Date","now","countdownManager","restartCountdown","$el","rewards","requestReward","setTimeout","newExpiry","qtokenid","flexHide","menuTemplate","id","createElement","classList","add","menuItem","createMenuItem","addGlobalEventListeners","menuButton","innerHTML","style","className","onclick","event","submenuContainer","createSubMenu","addEventListener","display","submenuItems","subItem","subMenuItem","nestedSubMenu","contains","closeAllSubmenus","key","querySelectorAll"],"mappings":"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"}