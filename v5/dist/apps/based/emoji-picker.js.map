{"version":3,"file":"emoji-picker.js","sources":["../../../apps/based/emoji-picker/emoji-picker.js"],"sourcesContent":["\nexport default class EmojiPickerClass {\n    constructor(bp) {\n        this.bp = bp;\n    }\n\n    async init() {\n        await this.bp.appendScript('/v5/apps/based/buddylist/vendor/emoji.min.js');\n        await this.bp.appendScript('/v5/apps/based/emoji-picker/vendor/grapheme-splitter.min.js')\n        this.jQueryPlugin();\n        return 'loaded emoji picker';\n    }\n\n    jQueryPlugin() {\n\n        $.fn.emojiPicker = function (options) {\n            const settings = $.extend({\n                onSelect: (emoji) => { },\n                categories: ['people', 'nature', 'food', 'activity', 'travel', 'objects', 'symbols', 'flags'],\n                emojiData: EMOJIS,\n            }, options);\n\n            const emojiList = Object.entries(settings.emojiData).map(([emoji, keywords]) => {\n                return {\n                    emoji,\n                    keywords,\n                    name: keywords[0] || '',\n                    search: keywords.join(' ') + ' ' + emoji\n                };\n            });\n            const createPicker = () => {\n                const $picker = $(`\n                <div class=\"emoji-picker-popup\" style=\"position: absolute; z-index: 9999; display: none; width: 260px; border: 1px solid #ccc; border-radius: 6px; box-shadow: 0 2px 10px rgba(0,0,0,0.15); background: var(--desktop_element-background);\">\n                    <input type=\"text\" class=\"emoji-search\" placeholder=\"Search...\" style=\"width: 100%; padding: 6px; border: none; border-bottom: 1px solid #eee; box-sizing: border-box;\" />\n                <div class=\"emoji-grid\" style=\"max-height: 200px; min-height: 200px; overflow-y: auto; padding: 6px; display: flex; flex-wrap: wrap; align-items: start; gap: 6px; font-size: 20px;\"></div>\n                </div>\n            `);\n\n                const $search = $picker.find('.emoji-search');\n                const $grid = $picker.find('.emoji-grid');\n\n                const render = (filter = '') => {\n                    $grid.empty();\n                    const results = emojiList.filter(e =>\n                        e.search.toLowerCase().includes(filter.toLowerCase())\n                    ).slice(0, 200);\n\n                    results.forEach(e => {\n                        const $item = $(`<button class=\"emoji-btn\" style=\"border: none; background: none; cursor: pointer;\">${e.emoji}</button>`);\n                        // set the title attribute to show the name on hover\n                        $item.attr('title', e.name || e.keywords.join(', '));\n                        $item.on('click', () => {\n                            settings.onSelect(e.emoji);\n                            // $picker.hide();\n                        });\n                        $grid.append($item);\n                    });\n                };\n\n                $search.on('input', () => {\n                    render($search.val());\n                });\n\n                render();\n                return $picker;\n            };\n\n            return this.each(function () {\n                const $trigger = $(this);\n                const $picker = createPicker();\n                $('body').append($picker);\n\n                // Shared function to show the picker\n                const showPicker = () => {\n                    $picker.css({ left: -9999, top: -9999, display: 'block' });\n\n                    const triggerOffset = $trigger.offset();\n                    const triggerHeight = $trigger.outerHeight();\n                    const pickerHeight = $picker.outerHeight();\n\n                    const left = triggerOffset.left;\n                    const top = triggerOffset.top - pickerHeight - 8;\n\n                    $picker.css({\n                        left: left,\n                        top: top < 0 ? triggerOffset.top + triggerHeight + 8 : top,\n                        display: 'block'\n                    });\n                };\n\n                // Option 1: Trigger from normal click\n                $trigger.on('click', function (e) {\n                    e.stopPropagation();\n                    showPicker();\n                });\n\n                // Option 2: Allow manual triggering\n                $trigger.data('emojiPicker_show', showPicker);\n\n                // Hide picker on outside click\n                $(document).on('click', function (e) {\n                    if (!$(e.target).closest('.emoji-picker-popup').length &&\n                        !$(e.target).is($trigger)) {\n                        $picker.hide();\n                    }\n                });\n            });\n        };\n\n\n    }\n\n}"],"names":["EmojiPickerClass","constructor","bp","this","init","appendScript","jQueryPlugin","$","fn","emojiPicker","options","settings","extend","onSelect","emoji","categories","emojiData","EMOJIS","emojiList","Object","entries","map","keywords","name","search","join","each","$trigger","$picker","$search","find","$grid","render","filter","empty","e","toLowerCase","includes","slice","forEach","$item","attr","on","append","val","createPicker","showPicker","css","left","top","display","triggerOffset","offset","triggerHeight","outerHeight","pickerHeight","stopPropagation","data","document","target","closest","length","is","hide"],"mappings":"AACe,MAAMA,EACjB,WAAAC,CAAYC,GACRC,KAAKD,GAAKA,CAClB,CAEI,UAAME,GAIF,aAHMD,KAAKD,GAAGG,aAAa,sDACrBF,KAAKD,GAAGG,aAAa,+DAC3BF,KAAKG,eACE,qBACf,CAEI,YAAAA,GAEIC,EAAEC,GAAGC,YAAc,SAAUC,GACzB,MAAMC,EAAWJ,EAAEK,OAAO,CACtBC,SAAWC,MACXC,WAAY,CAAC,SAAU,SAAU,OAAQ,WAAY,SAAU,UAAW,UAAW,SACrFC,UAAWC,QACZP,GAEGQ,EAAYC,OAAOC,QAAQT,EAASK,WAAWK,KAAI,EAAEP,EAAOQ,MACvD,CACHR,QACAQ,WACAC,KAAMD,EAAS,IAAM,GACrBE,OAAQF,EAASG,KAAK,KAAO,IAAMX,MAwC3C,OAAOX,KAAKuB,MAAK,WACb,MAAMC,EAAWpB,EAAEJ,MACbyB,EAvCW,MACjB,MAAMA,EAAUrB,EAAE,qrBAOZsB,EAAUD,EAAQE,KAAK,iBACvBC,EAAQH,EAAQE,KAAK,eAErBE,EAAS,CAACC,EAAS,MACrBF,EAAMG,QACUhB,EAAUe,QAAOE,GAC7BA,EAAEX,OAAOY,cAAcC,SAASJ,EAAOG,iBACzCE,MAAM,EAAG,KAEHC,SAAQJ,IACZ,MAAMK,EAAQjC,EAAE,sFAAsF4B,EAAErB,kBAExG0B,EAAMC,KAAK,QAASN,EAAEZ,MAAQY,EAAEb,SAASG,KAAK,OAC9Ce,EAAME,GAAG,SAAS,KACd/B,EAASE,SAASsB,EAAErB,UAGxBiB,EAAMY,OAAOH,OASrB,OALAX,EAAQa,GAAG,SAAS,KAChBV,EAAOH,EAAQe,UAGnBZ,IACOJ,GAKSiB,GAChBtC,EAAE,QAAQoC,OAAOf,GAGjB,MAAMkB,EAAa,KACflB,EAAQmB,IAAI,CAAEC,MAAM,KAAOC,KAAU,KAAEC,QAAS,UAEhD,MAAMC,EAAgBxB,EAASyB,SACzBC,EAAgB1B,EAAS2B,cACzBC,EAAe3B,EAAQ0B,cAEvBN,EAAOG,EAAcH,KACrBC,EAAME,EAAcF,IAAMM,EAAe,EAE/C3B,EAAQmB,IAAI,CACRC,KAAMA,EACNC,IAAKA,EAAM,EAAIE,EAAcF,IAAMI,EAAgB,EAAIJ,EACvDC,QAAS,WAKjBvB,EAASe,GAAG,SAAS,SAAUP,GAC3BA,EAAEqB,kBACFV,GACpB,IAGgBnB,EAAS8B,KAAK,mBAAoBX,GAGlCvC,EAAEmD,UAAUhB,GAAG,SAAS,SAAUP,GACzB5B,EAAE4B,EAAEwB,QAAQC,QAAQ,uBAAuBC,QAC3CtD,EAAE4B,EAAEwB,QAAQG,GAAGnC,IAChBC,EAAQmC,MAEhC,GACA,GACS,CAGT"}