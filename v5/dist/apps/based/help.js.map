{"version":3,"file":"help.js","sources":["../../../apps/based/help/help.js","../../../apps/based/help/lib/render.js","../../../apps/based/help/lib/eventBind.js"],"sourcesContent":["/* Help.js - Marak Squires 2025 - BuddyPond */\nimport render from './lib/render.js';\nimport eventBind from './lib/eventBind.js';\n\nexport default class Help {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        this.icon = 'desktop/assets/images/icons/icon_help_64.png';\n        return this;\n    }\n\n    async help () {\n        return `This is the help file for help you can't help but help\n        Choose any other app from the dropdown select to get more information about that app.\n        `;\n    }\n\n    async init() {\n\n        console.log('help is: under construction');\n\n        this.html = await this.bp.load('/v5/apps/based/help/help.html');\n        await this.bp.load('/v5/apps/based/help/help.css');\n        return 'loaded help window';\n    }\n    \n    async open (options = {}) {\n        if (!this.helpWindow) {\n            this.helpWindow = this.bp.apps.ui.windowManager.createWindow({\n                id: 'help',\n                title: 'Help',\n                icon: this.icon,\n                x: 250,\n                y: 75,\n                width: 400,\n                height: 400,\n                minWidth: 200,\n                minHeight: 200,\n                parent: $('#desktop')[0],\n                // content: '<h1>Message of the Day</h1><p>Under construction</p>',\n                resizable: true,\n                minimizable: true,\n                maximizable: true,\n                closable: true,\n                focusable: true,\n                maximized: false,\n                minimized: false,\n                onClose: () => {\n                    this.helpWindow = null\n                }\n            });\n        }\n\n        if (options.context === 'default') {\n            options.context = 'help';\n        }\n\n        await this.render(this.helpWindow);\n        this.eventBind(this.helpWindow);\n    }\n}\n\nHelp.prototype.render = render;\nHelp.prototype.eventBind = eventBind;","export default async function render (helpWindow) {\n    $(helpWindow.content).html(this.html);\n\n\n    if (this.bp.apps.desktop && this.bp.apps.desktop.apps) {\n        // for each registered app, add an option to the help-topics dropdown\n        let helpTopics = $('.help-topics', helpWindow.content);\n        let appKeys = Object.keys(this.bp.apps.desktop.apps);\n        appKeys.push('help'); // some apps not from desktop registered shortcuts ( for now )\n        // sort the apps by name\n        appKeys.sort();\n        //for (let app in this.bp.apps.desktop.apps) {\n        appKeys.forEach(app => {\n            // let appData = this.bp.apps.desktop.apps[app];\n            //if (appData.help) {\n                let option = $('<option>').attr('value', app).text(app);\n                helpTopics.append(option);\n            // }\n        });\n    }\n\n}","export default function eventBind (helpWindow){\n    console.log('eventBind', helpWindow);\n\n    // listen for window focus events\n    // when a window focuses, attempt to load help content by context / typoe\n    // TODO: add window::focus event..., WindowManager? probably ui app is smarter\n    this.bp.on('window::open', 'update-help-context', async (data) => {\n\n\n        // alert('window::open');\n        console.log('window::open', data);\n\n        let appId = data.id; // window id ( for now )\n        let type = data.type; // window type ( for now\n        // alert(appId)\n        // check if app has a help function\n        if (this.bp.apps[appId] && this.bp.apps[appId].help) {\n            // call the help function and set the content\n            let helpText = await this.bp.apps[appId].help();\n\n            $('.contextualHelpText', helpWindow.content).html(helpText);\n            $('.help-context', helpWindow.content).html(appId);\n            if (type !== 'singleton') {\n                $('.help-type', helpWindow.content).html(type);     \n            }\n            console.log('helpText', helpText);\n        } else {\n            console.log('no help function found for app', appId);\n        }\n\n        // set the val of the help-topics dropdown to the appId\n        $('.help-topics', helpWindow.content).val(appId);\n\n    });\n\n    // when the .help-topics selector changes, attempt to run the help() function for the selected app\n    $('.help-topics', helpWindow.content).on('change', async (ev) => {\n        let appId = $(ev.target).val();\n\n        await this.bp.load(appId);\n\n        let app = this.bp.apps[appId];\n        console.log('app', app);\n        // update the help context\n        let iconSrc = this.bp.apps[appId].icon;\n        console.log('iconSrc', iconSrc);\n\n\n        if (!iconSrc) {\n            iconSrc = `desktop/assets/images/icons/icon_${appId}_64.png`;\n        }\n\n        if (iconSrc) {\n            $('.help-context', helpWindow.content).html(`<img src=\"${iconSrc}\" class=\"icon\" /> ${appId}`);\n        } else {\n            $('.help-context', helpWindow.content).html(appId);\n        }\n\n\n        $('.help-context', helpWindow.content).attr('data-app', appId);\n\n        if (this.bp.apps[appId] && this.bp.apps[appId].help) {\n            let helpText = await this.bp.apps[appId].help();\n            $('.contextualHelpText', helpWindow.content).html(helpText);\n            console.log('helpText', helpText);\n        } else {\n            console.log('no help function found for app', appId);\n        }\n    });\n\n    $('.help-context', helpWindow.content).on('click', async (ev) => {\n        // opens the app\n        let appId = $(ev.target).closest('.help-context').attr('data-app');\n        console.log(ev.target)\n        console.log('appId', appId);\n        this.bp.open(appId);\n    });\n\n\n}"],"names":["Help","constructor","bp","options","this","icon","help","init","console","log","html","load","open","helpWindow","apps","ui","windowManager","createWindow","id","title","x","y","width","height","minWidth","minHeight","parent","$","resizable","minimizable","maximizable","closable","focusable","maximized","minimized","onClose","context","render","eventBind","prototype","async","content","desktop","helpTopics","appKeys","Object","keys","push","sort","forEach","app","option","attr","text","append","on","data","appId","type","helpText","val","ev","target","iconSrc","closest"],"mappings":"AAIe,MAAMA,EACjB,WAAAC,CAAYC,EAAIC,EAAU,IAGtB,OAFAC,KAAKF,GAAKA,EACVE,KAAKC,KAAO,+CACLD,IACf,CAEI,UAAME,GACF,MAAO,iKAGf,CAEI,UAAMC,GAMF,OAJAC,QAAQC,IAAI,+BAEZL,KAAKM,WAAaN,KAAKF,GAAGS,KAAK,uCACzBP,KAAKF,GAAGS,KAAK,gCACZ,oBACf,CAEI,UAAMC,CAAMT,EAAU,IACbC,KAAKS,aACNT,KAAKS,WAAaT,KAAKF,GAAGY,KAAKC,GAAGC,cAAcC,aAAa,CACzDC,GAAI,OACJC,MAAO,OACPd,KAAMD,KAAKC,KACXe,EAAG,IACHC,EAAG,GACHC,MAAO,IACPC,OAAQ,IACRC,SAAU,IACVC,UAAW,IACXC,OAAQC,EAAE,YAAY,GAEtBC,WAAW,EACXC,aAAa,EACbC,aAAa,EACbC,UAAU,EACVC,WAAW,EACXC,WAAW,EACXC,WAAW,EACXC,QAAS,KACL/B,KAAKS,WAAa,SAKN,YAApBV,EAAQiC,UACRjC,EAAQiC,QAAU,cAGhBhC,KAAKiC,OAAOjC,KAAKS,YACvBT,KAAKkC,UAAUlC,KAAKS,WAC5B,EAGAb,EAAKuC,UAAUF,OC9DAG,eAAuB3B,GAIlC,GAHAc,EAAEd,EAAW4B,SAAS/B,KAAKN,KAAKM,MAG5BN,KAAKF,GAAGY,KAAK4B,SAAWtC,KAAKF,GAAGY,KAAK4B,QAAQ5B,KAAM,CAEnD,IAAI6B,EAAahB,EAAE,eAAgBd,EAAW4B,SAC1CG,EAAUC,OAAOC,KAAK1C,KAAKF,GAAGY,KAAK4B,QAAQ5B,MAC/C8B,EAAQG,KAAK,QAEbH,EAAQI,OAERJ,EAAQK,SAAQC,IAGR,IAAIC,EAASxB,EAAE,YAAYyB,KAAK,QAASF,GAAKG,KAAKH,GACnDP,EAAWW,OAAOH,KAGlC,CAEA,ED0CAnD,EAAKuC,UAAUD,UE/DA,SAAoBzB,GAC/BL,QAAQC,IAAI,YAAaI,GAKzBT,KAAKF,GAAGqD,GAAG,eAAgB,uBAAuBf,MAAOgB,IAIrDhD,QAAQC,IAAI,eAAgB+C,GAE5B,IAAIC,EAAQD,EAAKtC,GACbwC,EAAOF,EAAKE,KAGhB,GAAItD,KAAKF,GAAGY,KAAK2C,IAAUrD,KAAKF,GAAGY,KAAK2C,GAAOnD,KAAM,CAEjD,IAAIqD,QAAiBvD,KAAKF,GAAGY,KAAK2C,GAAOnD,OAEzCqB,EAAE,sBAAuBd,EAAW4B,SAAS/B,KAAKiD,GAClDhC,EAAE,gBAAiBd,EAAW4B,SAAS/B,KAAK+C,GAC/B,cAATC,GACA/B,EAAE,aAAcd,EAAW4B,SAAS/B,KAAKgD,GAE7ClD,QAAQC,IAAI,WAAYkD,EACpC,MACYnD,QAAQC,IAAI,iCAAkCgD,GAIlD9B,EAAE,eAAgBd,EAAW4B,SAASmB,IAAIH,MAK9C9B,EAAE,eAAgBd,EAAW4B,SAASc,GAAG,UAAUf,MAAOqB,IACtD,IAAIJ,EAAQ9B,EAAEkC,EAAGC,QAAQF,YAEnBxD,KAAKF,GAAGS,KAAK8C,GAEnB,IAAIP,EAAM9C,KAAKF,GAAGY,KAAK2C,GACvBjD,QAAQC,IAAI,MAAOyC,GAEnB,IAAIa,EAAU3D,KAAKF,GAAGY,KAAK2C,GAAOpD,KAiBlC,GAhBAG,QAAQC,IAAI,UAAWsD,GAGlBA,IACDA,EAAU,oCAAoCN,YAG9CM,EACApC,EAAE,gBAAiBd,EAAW4B,SAAS/B,KAAK,aAAaqD,sBAA4BN,KAErF9B,EAAE,gBAAiBd,EAAW4B,SAAS/B,KAAK+C,GAIhD9B,EAAE,gBAAiBd,EAAW4B,SAASW,KAAK,WAAYK,GAEpDrD,KAAKF,GAAGY,KAAK2C,IAAUrD,KAAKF,GAAGY,KAAK2C,GAAOnD,KAAM,CACjD,IAAIqD,QAAiBvD,KAAKF,GAAGY,KAAK2C,GAAOnD,OACzCqB,EAAE,sBAAuBd,EAAW4B,SAAS/B,KAAKiD,GAClDnD,QAAQC,IAAI,WAAYkD,EACpC,MACYnD,QAAQC,IAAI,iCAAkCgD,MAItD9B,EAAE,gBAAiBd,EAAW4B,SAASc,GAAG,SAASf,MAAOqB,IAEtD,IAAIJ,EAAQ9B,EAAEkC,EAAGC,QAAQE,QAAQ,iBAAiBZ,KAAK,YACvD5C,QAAQC,IAAIoD,EAAGC,QACftD,QAAQC,IAAI,QAASgD,GACrBrD,KAAKF,GAAGU,KAAK6C,KAIrB"}