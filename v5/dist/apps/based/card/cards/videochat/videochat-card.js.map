{"version":3,"file":"videochat-card.js","sources":["../../../../../../apps/based/card/cards/videochat/videochat-card.js"],"sourcesContent":["export default function applyData(el, data) {\n    const $el = $(el);\n\n    let headerEl = $el.find('.card-videocall-header');\n    let acceptEl = $el.find('.accept-call');\n    let declineEl = $el.find('.decline-call');\n\n    if (data.message.from === this.bp.me) {\n        headerEl.text('Outgoing call to ' + data.message.to);\n        acceptEl.text('Open videocall');\n        declineEl.hide(); // Hide decline button for outgoing calls\n    } else {\n        headerEl.text('Incoming call from ' + data.message.from);\n        acceptEl.text('Accept call');\n        declineEl.text('Decline');\n    }\n\n    // Handle accept button click\n    $el.find('.accept-call').click(() => {\n        if (data.message.from === this.bp.me) {\n            this.bp.open('videochat', { type: 'buddy', context: data.message.to, isHost: true });\n        } else {\n            this.bp.open('videochat', { type: 'buddy', context: data.message.from, acceptedCall: true });\n        }\n    });\n\n    // Handle decline button click\n    $el.find('.decline-call').click(() => {\n        // Optionally notify the caller or perform cleanup\n        console.log('Call declined');\n        //$el.remove(); // Remove the card from the chat\n        return false;\n    });\n\n    const now = new Date();\n    const messageDate = new Date(data.message.ctime);\n    const timeDiff = (now.getTime() - messageDate.getTime()) / 1000;\n    // console.log('timeDiff', timeDiff);\n\n    if (timeDiff > 10 || data.message.from === this.bp.me) {\n        return;\n    }\n\n    console.log('opening videocall app', el, data);\n\n    this.bp.open('videochat', { type: 'buddy', context: data.message.from });\n}"],"names":["applyData","el","data","$el","$","headerEl","find","acceptEl","declineEl","message","from","this","bp","me","text","to","hide","click","open","type","context","isHost","acceptedCall","console","log","now","Date","messageDate","ctime","getTime"],"mappings":"AAAe,SAASA,EAAUC,EAAIC,GAClC,MAAMC,EAAMC,EAAEH,GAEd,IAAII,EAAWF,EAAIG,KAAK,0BACpBC,EAAWJ,EAAIG,KAAK,gBACpBE,EAAYL,EAAIG,KAAK,iBAErBJ,EAAKO,QAAQC,OAASC,KAAKC,GAAGC,IAC9BR,EAASS,KAAK,oBAAsBZ,EAAKO,QAAQM,IACjDR,EAASO,KAAK,kBACdN,EAAUQ,SAEVX,EAASS,KAAK,sBAAwBZ,EAAKO,QAAQC,MACnDH,EAASO,KAAK,eACdN,EAAUM,KAAK,YAInBX,EAAIG,KAAK,gBAAgBW,OAAM,KACvBf,EAAKO,QAAQC,OAASC,KAAKC,GAAGC,GAC9BF,KAAKC,GAAGM,KAAK,YAAa,CAAEC,KAAM,QAASC,QAASlB,EAAKO,QAAQM,GAAIM,QAAQ,IAE7EV,KAAKC,GAAGM,KAAK,YAAa,CAAEC,KAAM,QAASC,QAASlB,EAAKO,QAAQC,KAAMY,cAAc,OAK7FnB,EAAIG,KAAK,iBAAiBW,OAAM,KAE5BM,QAAQC,IAAI,kBAEL,KAGX,MAAMC,EAAM,IAAIC,KACVC,EAAc,IAAID,KAAKxB,EAAKO,QAAQmB,QACxBH,EAAII,UAAYF,EAAYE,WAAa,IAG5C,IAAM3B,EAAKO,QAAQC,OAASC,KAAKC,GAAGC,KAInDU,QAAQC,IAAI,wBAAyBvB,EAAIC,GAEzCS,KAAKC,GAAGM,KAAK,YAAa,CAAEC,KAAM,QAASC,QAASlB,EAAKO,QAAQC,OACrE"}