class e{constructor(e,o={}){return this.bp=e,this}async init(){this.bp.log("Hello from SoundRecorder");let e=window.addEventListener?"addEventListener":"attachEvent";return(0,window[e])("attachEvent"==e?"onmessage":"message",(e=>{console.log("desktop.app.soundrecorder: message received",e);let o=e[e.message?"message":"data"];if("app_soundrecorder_needs_close"!==o)try{let e=JSON.parse(o);console.log("desktop.app.soundrecorder: message received:",e),console.log("emit buddy::sendMessage",e),bp.emit("buddy::sendMessage",e)}catch(e){console.error("desktop.app.soundrecorder: error parsing message:",e)}else this.soundRecorderWindow.close()}),!1),"loaded SoundRecorder"}async open(e={}){if(!this.soundRecorderWindow){let o="",s="",d="";e.type&&(d="&type="+e.type),e.context&&(s="&context="+e.context),e.soundUrl&&(desktop.app.soundrecorder.activeSound=e.soundUrl,o="&src="+e.soundUrl);let r,n="";bp.apps.client.api.qtokenid&&(n="&_qtokenid="+bp.apps.client.api.qtokenid+`&_me=${bp.me}`),r=e.soundUrl?`v5/apps/based/soundrecorder/vendor/programs/sound-recorder/index.html?AC=3${n}${o}${d}${s}`:`v5/apps/based/soundrecorder/vendor/programs/sound-recorder/index.html?AC=3${n}${d}${s}`,this.soundRecorderWindow=this.bp.apps.ui.windowManager.createWindow({id:"soundrecorder",title:"Sound Recorder",x:50,y:100,width:662,height:388,minWidth:200,minHeight:200,parent:$("#desktop")[0],icon:"/desktop/assets/images/icons/icon_soundrecorder_64.png",iframeContent:r,resizable:!0,minimizable:!0,maximizable:!0,closable:!0,focusable:!0,maximized:!1,minimized:!1,onClose:()=>{this.soundRecorderWindow=null}})}this.bp.apps.ui.windowManager.focusWindow(this.soundRecorderWindow)}}export{e as default};
//# sourceMappingURL=soundrecorder.js.map
