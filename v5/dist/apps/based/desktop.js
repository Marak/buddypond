class e{constructor(e,t={}){this.data=e,this.parentElement=t.parentElement,this.desktop=t.desktop,this.depth=t.depth,this.options=t}render(e={}){e=this.data;const t=document.createElement("div");t.className=`folder ${e.class||""}`,this.depth>1&&t.classList.add("hidden"),t.classList.add("icon","shortcut");const o=document.createElement("a"),n=document.createElement("img");n.className="bp-desktop-icon",n.loading="lazy",n.src="desktop/assets/images/icons/icon_folder_64.png";const s=document.createElement("span");s.className="title",s.textContent=e.label||e.name||e.id,o.appendChild(n),o.appendChild(s),t.appendChild(o),$(t).draggable({containment:"parent"}),t.addEventListener("mousedown",(e=>{this.options.onOpen()})),this.parentElement.appendChild(t)}open(){this.options.onOpen()}}class t{constructor(e,t,o,n){this.data=e,console.log("FIKLE DATA",e),this.parentElement=t,this.desktop=o,this.options={},this.depth=n}render(e={}){e=this.data;const t=document.createElement("div");t.className=`icon shortcut ${e.class||""}`,this.depth>1&&t.classList.add("hidden"),t.classList.add("icon","shortcut");const o=document.createElement("a"),n=document.createElement("img");n.className="bp-desktop-icon",n.loading="lazy",n.src=e.icon;const s=document.createElement("span");s.className="title",s.textContent=e.label||e.name||e.id,o.appendChild(n),o.appendChild(s),t.appendChild(o),t.addEventListener("click",this.options.onClick),this.enableShortcutDragging&&$(t).draggable({containment:"parent"}),this.parentElement.appendChild(t)}}class o{constructor(e,t={}){this.bp=e,this.options=t,this.apps={},this.folders=[],this.container=document.createElement("div"),this.container.id="desktop-container",this.container.className="desktop-container",this.shortCutsContainer=document.createElement("div"),this.shortCutsContainer.id="desktop-shortcuts-container",this.shortCutsContainer.className="desktop-shortcuts-container",this.container.appendChild(this.shortCutsContainer),this.parent=t.parent||document.body,this.parent.appendChild(this.container),this.enableShortcutDragging=!0,"boolean"==typeof t.enableShortcutDragging&&(this.enableShortcutDragging=t.enableShortcutDragging),this.setupContextMenu()}async init(){return await this.bp.load("/v5/apps/based/desktop/desktop.css"),function(){function e(){bp.apps.desktop.addShortCut({name:"coin",icon:"desktop/assets/images/icons/icon_coin_64.png",label:"Buddy Coins",description:"Manage your virtual currency"},{onClick:()=>{bp.open("coin")}}),bp.apps.desktop.addShortCut({name:"portfolio",icon:"desktop/assets/images/icons/icon_portfolio_64.png",label:"Portfolio",description:"Track your investments and assets"},{onClick:()=>{bp.open("portfolio")}}),bp.apps.desktop.arrangeShortcuts(3)}bp.apps.desktop.addShortCut({name:"profile",icon:"desktop/assets/images/icons/icon_profile_64.png",label:"My Profile",description:"Manage your profile and settings"},{onClick:()=>{bp.open("profile")}}),bp.apps.desktop.addShortCut({name:"buddylist",icon:"desktop/assets/images/icons/icon_profile_64.png",label:"BuddyList",description:"View and manage your contacts"},{onClick:()=>{bp.open("buddylist")}}),bp.apps.desktop.addShortCut({name:"pad",icon:"desktop/assets/images/icons/icon_pad_64.png",label:"Pads",description:"Create hosted Apps for Buddy Pond"},{onClick:()=>{bp.open("pad")}}),bp.apps.desktop.addShortCut({name:"pond",icon:"desktop/assets/images/icons/icon_pond_64.png",label:"Ponds",description:"Explore shared content or communities"},{onClick:()=>{bp.open("pond")}}),bp.isMobile()||bp.apps.desktop.addShortCut({name:"file-explorer",icon:"desktop/assets/images/icons/icon_file-explorer_64.png",label:"Buddy Files",description:"Browse and manage your files"},{onClick:()=>{bp.open("file-explorer")}}),bp.apps.desktop.addShortCut({name:"paint",icon:"desktop/assets/images/icons/icon_paint_64.png",label:"Paint",description:"Create and edit digital artwork"},{onClick:()=>{bp.open("paint")}}),bp.isMobile()||bp.apps.desktop.addShortCut({name:"soundrecorder",icon:"desktop/assets/images/icons/icon_soundrecorder_64.png",label:"Sound Recorder",description:"Record and save audio clips"},{onClick:()=>{bp.open("soundrecorder")}}),bp.apps.desktop.addShortCut({name:"youtube",icon:"desktop/assets/images/icons/icon_interdimensionalcable_64.png",label:"Youtube",description:"Watch and browse YouTube videos"},{onClick:()=>{bp.open("youtube")}}),bp.apps.desktop.addShortCut({name:"camera",icon:"desktop/assets/images/icons/icon_camera_64.png",label:"Camera",description:"Capture photos or videos"},{onClick:()=>{bp.open("camera")}}),bp.isMobile()||bp.apps.desktop.addShortCut({name:"piano",icon:"desktop/assets/images/icons/icon_piano_64.png",label:"Piano",description:"Play a virtual piano keyboard"},{onClick:()=>{bp.open("piano")}}),bp.apps.desktop.addShortCut({name:"fluid-simulation",icon:"desktop/assets/images/icons/icon_fluidsimulation_64.png",label:"Fluid Simulation",description:"Interact with a fluid dynamics simulation"},{onClick:()=>{bp.open("fluid-simulation")}}),bp.apps.desktop.addShortCut({name:"sampler",icon:"desktop/assets/images/icons/icon_midifighter_64.png",label:"Sampler",description:"Create and mix audio samples"},{onClick:()=>{bp.open("sampler")}}),bp.apps.desktop.addShortCut({name:"audio-visual",icon:"desktop/assets/images/icons/icon_visuals_64.png",label:"Audio Visuals",description:"Experience audio-responsive visuals"},{onClick:()=>{bp.open("audio-visual")}}),window.coinBeta=e,bp.apps.desktop.addFolder({name:"Games",height:250,items:[{id:"mantra",label:"Mantra",description:"Play the Mantra game"},{id:"minesweeper",label:"Minesweeper",description:"Classic Minesweeper puzzle game"},{id:"emulator",label:"NES",options:{context:"nes"},icon:"desktop/assets/images/icons/icon_nes_64.png",description:"Play Nintendo Entertainment System games"},{id:"emulator",label:"Sega",options:{context:"sega"},icon:"desktop/assets/images/icons/icon_sega_64.png",description:"Play Sega console games"},{id:"emulator",label:"SNES",options:{context:"snes"},icon:"desktop/assets/images/icons/icon_snes_64.png",description:"Play Super Nintendo games"},{id:"emulator",label:"Atari 2600",options:{context:"atari2600"},icon:"desktop/assets/images/icons/icon_atari2600_64.png",description:"Play Atari 2600 games"},{id:"emulator",label:"n64",options:{context:"n64"},icon:"desktop/assets/images/icons/icon_n64_64.png",description:"Play Nintendo 64 games"},{id:"solitaire",label:"Solitaire",description:"Classic Solitaire card game"}]}),bp.apps.desktop.addFolder({name:"Hacking Tools",width:320,height:220,items:[{id:"globe",label:"Globe",description:"Visualize global network data"},{id:"hacker-typer",label:"Hack Typer",description:"Simulate hacking with a typing game"},{id:"hex-editor",label:"Hex Editor",description:"Edit files in hexadecimal format"},{id:"maps",label:"Maps",description:"Access mapping and navigation tools"},{id:"spellbook",label:"Spellbook",description:"Manage scripts or commands"}]}),bp.apps.desktop.addShortCut({name:"audio-player",icon:"desktop/assets/images/icons/icon_audio-player_64.png",label:"Audio Player",description:"Play and manage audio files"},{onClick:()=>{bp.open("audio-player")}}),e()}(),"loaded desktop"}async load(){}renderNode(o,s,i=0,a=!1){if(console.log("renderNode",o,s,i,a),o.children&&o.children.length>0)if(a)o.children.forEach((e=>this.renderNode(e,s,i+1)));else{new e(o,s,this,i).render()}else if(o.text.endsWith(".yml")){new n(o,s).render()}else{new t(o,s,this,i).render()}}toggleMute(){!1===this.bp.settings.audio_enabled?(this.bp.set("audio_enabled",!0),$(".volumeFull").show(),$(".volumeMuted").hide(),this.bp.play("desktop/assets/audio/VOLUME-ON.mp3",{tryHard:1/0})):(this.bp.set("audio_enabled",!1),$(".volumeFull").hide(),$(".volumeMuted").show())}openFolder(e){console.log("openFolder",e);const t=this.folders.find((t=>t.data.name===e));t?t.open():console.error(`Folder with ID ${e} not found.`)}}o.prototype.Folder=e,o.prototype.File=t,o.prototype.addShortCut=function(e,t={},o){"function"!=typeof t.onClick&&(t.onClick=()=>console.log("desktop app - Missing options.onClick function",e.name));const n=document.createElement("div");n.className=`icon shortcut ${e.class||""} bp-desktop-shortcut`;const s=document.createElement("a");if(s.href=e.href||`#icon_dock_${e.name}`,e.textIcon){const o=document.createElement("div");o.textContent=e.textIcon,o.style.fontSize="32px",o.style.position="relative",o.style.bottom="10px",t.imageStyle&&Object.keys(t.imageStyle).forEach((e=>{o.style[e]=t.imageStyle[e]})),s.appendChild(o)}else{const o=document.createElement("img");o.className="bp-desktop-icon",o.loading="lazy",o.src=e.icon,t.imageStyle&&Object.keys(t.imageStyle).forEach((e=>{o.style[e]=t.imageStyle[e]})),s.appendChild(o)}const i=document.createElement("span");i.className="title",i.textContent=e.label||e.name,s.appendChild(i),n.appendChild(s),n.addEventListener("click",(o=>(o.preventDefault(),t.onClick(o,e),!1))),(o||this.shortCutsContainer).appendChild(n),this.enableShortcutDragging&&$(n).draggable({containment:"parent"}),e.options=t,t&&t.context?this.apps[e.name+"-"+t.context]=e:this.apps[e.name]=e},o.prototype.addFolder=function(t){let o=this,n=document.createElement("div");n.className="folder-holder",t.items.forEach((e=>{!function(e,t){let n={};"string"==typeof e?(n.id=e,n.name=e,n.label=e):n=e,n.icon||(n.icon=`/desktop/assets/images/icons/icon_${n.id}_64.png`),n.options=n.options||{},o.addShortCut({name:n.id,icon:n.icon,label:n.label},{onClick:()=>{bp.open(n.id,n.options)},...n.options},t)}(e,n)}));const s=new e(t,{desktop:this,parentElement:this.shortCutsContainer,depth:0,onOpen:()=>{this.arrangeShortcuts(4,{parent:n,x:0,y:20}),console.log("Folder opened:",t.name),this.bp.apps.ui.windowManager.createWindow({id:t.name,title:t.name,icon:"/desktop/assets/images/icons/icon_folder.png",width:t.width||400,height:t.height||150,parent:$("#desktop").get(0),content:n})}});this.folders.push(s),s.render()},o.prototype.removeShortCut=function(e){const t=Array.from(this.shortCutsContainer.children).find((t=>t.querySelector(".title").textContent===e));t&&this.shortCutsContainer.removeChild(t)},o.prototype.arrangeShortcuts=function(e=4,t={rowWidth:74,rowHeight:100,x:0,y:0}){let o;o=void 0!==t.parent?t.parent:this.shortCutsContainer,"number"!=typeof t.rowWidth&&(t.rowWidth=74,this.bp.isMobile()&&(t.rowWidth=256)),"number"!=typeof t.rowHeight&&(t.rowHeight=100,this.bp.isMobile()&&(t.rowHeight=256)),"number"!=typeof t.x&&(t.x=0),"number"!=typeof t.y&&(t.y=0);const n=o.offsetWidth||800,s=Math.floor(n/t.rowWidth),i=e<s?e:s;Array.from(o.children).forEach(((e,o)=>{let n=o%i*t.rowWidth,s=Math.floor(o/i)*t.rowHeight;this.bp.isMobile()&&(s+=100);n+=15,n+=t.x,s+=t.y,e.style.position="absolute",e.style.left=`${n}px`,e.style.top=`${s}px`}))},o.prototype.setupContextMenu=function(){this.container.oncontextmenu=e=>{e.preventDefault(),this.showContextMenu(e.clientX,e.clientY)}},o.prototype.showContextMenu=function(e,t){const o=document.createElement("div");o.className="desktop-context-menu",o.style.top=`${t}px`,o.style.left=`${e}px`,o.style.display="block",o.style.zIndex="9999",o.innerHTML='\n        <ul>\n            <li onclick="bp.apps.wallpaper.setWallpaper()">Set Wallpaper to Url</li>\n            <li onclick="bp.apps.wallpaper.removeWallpaper()">Remove Wallpaper</li>\n            <li onclick="bp.apps.desktop.viewSource()">View Source</li>\n        </ul>\n    ',document.body.appendChild(o),document.addEventListener("click",(()=>o.remove()),{once:!0})},o.prototype.viewSource=async function(e="https://raw.githubusercontent.com/Marak/buddypond/refs/heads/master/index.html"){const t=await fetch(e),o=await t.text();await this.bp.load("editor-monaco",{content:o}),this.bp.apps["editor-monaco"].open()},o.prototype.showDesktopIcons=function(){this.shortCutsContainer.style.display="flex",this.bp.isMobile()&&(this.shortCutsContainer.style.position="absolute",this.shortCutsContainer.style.left="0px",this.shortCutsContainer.style.bottom="0px")};class n{constructor(e,t){this.data=e,this.parentElement=t}render(){const e=document.createElement("div");e.textContent=this.data.text||this.data.id,e.className="shortcut",e.classList.add("icon","shortcut","bp-desktop-iconp"),this.parentElement.appendChild(e)}}export{o as default};
//# sourceMappingURL=desktop.js.map
