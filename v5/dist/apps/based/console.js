class t{constructor(e,t={}){return this.bp=e,this}async init(){return this.bp.log("Hello from Console"),await this.bp.load("/v5/apps/based/console/console.css"),this.html=await this.bp.load("/v5/apps/based/console/console.html"),$(document).on("keydown",(e=>{if(192==event.which&&event.shiftKey)return this.open(),!1})),"loaded Console"}async open(){let t=this.bp.apps.ui.windowManager.createWindow({id:"console",title:"Console",x:50,y:100,width:800,height:400,minWidth:200,minHeight:200,parent:$("#desktop")[0],content:this.html,resizable:!0,minimizable:!0,maximizable:!0,closable:!0,focusable:!0,maximized:!1,minimized:!1,onOpen:()=>{$(".console_message_text",this.content).focus()}});this.consoleWindow=t;let o=Object.keys(this.bp.apps.buddyscript.commands).map((e=>"/"+e));return $(".console_message_text",t.content).autocomplete({source:o}),$(".console_send_message_form",t.content).on("submit",(e=>(e.preventDefault(),!1))),$(".consoleMessageSubmit",t.content).on("click",(()=>{let o=$(".console_message_text",t.content).val();return this.bp.apps.buddyscript.parseCommand(o),this.log(o),$(".console_message_text",t.content).val(""),e.preventDefault(),!1})),$(".console_message_text",t.content).on("keypress",(e=>{if(13===e.which){let o=$(".console_message_text",t.content).val(),s=this.bp.apps.buddyscript.parseCommand(o);return console.log("buddyscript result",s),$(".console_message_text",t.content).val(""),s.pipe?(s.pipe({chatWindow:t,contextName:"console",windowType:"console"}),!1):(this.log(o),e.preventDefault(),!1)}})),$(".console_message_text",t.content).focus(),t}log(e){$(".console li").length>10&&$(".console li").get(0).remove();let t=e,o=DateFormat.format.date(new Date,"HH:mm:ss");$(".console").append("<li>"+o+": "+t+"</li>")}}export{t as default};
//# sourceMappingURL=console.js.map
