(function(e,n){typeof exports=="object"&&typeof module<"u"?module.exports=n():typeof define=="function"&&define.amd?define(n):(e=typeof globalThis<"u"?globalThis:e||self,e.BP=n())})(this,function(){"use strict";const e={};window.bp=e,e.log=console.log,e.error=console.error,e.apps={},e.data={},e.start=async function(t=[]){for(let o of t)typeof o=="string"&&(e.log("loading async import app",o),await e.importModule(o,{},!0)),typeof o=="object"&&(e.log("loading async import app",o.name),await e.importModule(o.name,o,!0))};let n="http://192.168.200.59:5174";return e.importModule=async function(t,o,r=!0){let l=n+`/apps/based/${t}/${t}.js`;r||(l=t);try{console.log("modulePath",l);let c=await import(l);r&&(e.apps[t]=new c.default(e,o),await e.apps[t].init(),e.log("init complete",t))}catch(c){e.error("Failed to load module:",t,c),delete e.apps[t]}},e.fetchHTMLFragment=function(t){let o=`${n}${t}`;return fetch(o).then(r=>r.text())},e.appendCSS=function(t){let o=`${n}${t}`,r=document.createElement("link");r.rel="stylesheet",r.href=o,document.head.appendChild(r)},e.appendScript=async function(t){let o=`${n}${t}`,r=document.createElement("script");return r.src=o,document.head.appendChild(r),new Promise((l,c)=>{r.onload=l,r.onerror=c})},e.createWorker=async function(t,o={}){let r=`${n}${t}`;try{const c=await(await fetch(r)).blob(),s=URL.createObjectURL(c);let a=o||{};const f=new Worker(s,a);return console.log("Worker injected:",t),f}catch(l){return console.error("Failed to load worker script:",t,l),null}},e._emitters={},e.emit=function(t,...o){e.log("emit",t,...o),e._emitters[t]&&e._emitters[t].forEach(r=>{r.callback&&r.callback(...o)})},e.on=function(t,o,r){if(!t||!o||!r)throw new Error("Missing required parameters for on()");e._emitters[t]||(e._emitters[t]=[]),e._emitters[t].push({label:o,callback:r}),e.log("on",t,o)},e.off=function(t,o){e.log("off",t,o),e._emitters[t]&&(e._emitters[t]=e._emitters[t].filter(r=>r.label!==o))},e.me="Guest",e});
